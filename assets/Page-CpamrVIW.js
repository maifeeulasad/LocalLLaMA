import{j as e}from"./index-Cd3v0jxz.js";import{R as t}from"./RedditPostRenderer-cI96YLhy.js";import"./index-DGBoKyQm.js";const a=JSON.parse(`[{"kind":"Listing","data":{"after":null,"dist":1,"modhash":"","geo_filter":"","children":[{"kind":"t3","data":{"approved_at_utc":null,"subreddit":"LocalLLaMA","selftext":"Hello everyone, I am one of the core maintainers of Arch (https://github.com/katanemo/archgw), an open-source proxy for LLMs written in Rust. A few days ago we launched Arch-Router (https://huggingface.co/katanemo/Arch-Router-1.5B) on HuggingFace, a 1.5B router model designed for preference-aligned routing (and of course integrated in the proxy server). Full paper: [https://arxiv.org/abs/2506.16655](https://arxiv.org/abs/2506.16655)  \\n  \\nAs teams integrate multiple LLMs - each with different strengths, styles, or cost/latency profiles — routing the right prompt to the right model becomes a critical part of the application design. But it’s still an open problem. Existing routing systems fall into two camps:\\n\\n* **Embedding-based or semantic routers** map the user’s prompt to a dense vector and route based on similarity — but they struggle in practice: they lack context awareness (so follow-ups like “And Boston?” are misrouted), fail to detect negation or logic (“I don’t want a refund” vs. “I want a refund”), miss rare or emerging intents that don’t form clear clusters, and can’t handle short, vague queries like “cancel” without added context.\\n* **Performance-based routers** pick models based on benchmarks like MMLU or MT-Bench, or based on latency or cost curves. But benchmarks often miss what matters in production: domain-specific quality or subjective preferences especially as developers evaluate the effectiveness of their prompts against selected models.\\n\\nArch-Router takes a different approach: route by preferences written in plain language. You write rules like “contract clauses → GPT-4o” or “quick travel tips → Gemini Flash.” The router maps the prompt (and conversation context) to those rules using a lightweight 1.5B autoregressive model. No retraining, no fragile if/else chains. We built this with input from teams at Twilio and Atlassian. It handles intent drift, supports multi-turn conversations, and lets you swap in or out models with a one-line change to the routing policy. Full details are in our paper (https://arxiv.org/abs/2506.16655), but here’s a snapshot:\\n\\nSpecs:\\n\\n* 1.5B parameters — runs on a single GPU (or CPU for testing) \\n* No retraining needed — point it at any mix of LLMs\\n* Outperforms larger closed models on conversational routing benchmarks (details in the paper)\\n\\nHope you enjoy the paper, the model and the usage integrated via the proxy ","user_reports":[],"saved":false,"mod_reason_title":null,"gilded":0,"clicked":false,"title":"An alternative to semantic or benchmark-based routing: A preference-aligned router model","link_flair_richtext":[{"e":"text","t":"New Model"}],"subreddit_name_prefixed":"r/LocalLLaMA","hidden":false,"pwls":6,"link_flair_css_class":"","downs":0,"thumbnail_height":53,"top_awarded_type":null,"hide_score":false,"name":"t3_1lxgm02","quarantine":false,"link_flair_text_color":"light","upvote_ratio":1,"author_flair_background_color":null,"ups":17,"total_awards_received":0,"media_embed":{},"thumbnail_width":140,"author_flair_template_id":null,"is_original_content":false,"author_fullname":"t2_gwq7fd01b","secure_media":null,"is_reddit_media_domain":true,"is_meta":false,"category":null,"secure_media_embed":{},"link_flair_text":"New Model","can_mod_post":false,"score":17,"approved_by":null,"is_created_from_ads_ui":false,"author_premium":false,"thumbnail":"https://b.thumbs.redditmedia.com/wCvH1bd89XPNT-dasyfXF6tKeu4OPxnliDzGh7KTD4Y.jpg","edited":false,"author_flair_css_class":null,"author_flair_richtext":[],"gildings":{},"post_hint":"image","content_categories":null,"is_self":false,"subreddit_type":"public","created":1752263600,"link_flair_type":"richtext","wls":6,"removed_by_category":null,"banned_by":null,"author_flair_type":"text","domain":"i.redd.it","allow_live_comments":false,"selftext_html":"&lt;!-- SC_OFF --&gt;&lt;div class=\\"md\\"&gt;&lt;p&gt;Hello everyone, I am one of the core maintainers of Arch (&lt;a href=\\"https://github.com/katanemo/archgw\\"&gt;https://github.com/katanemo/archgw&lt;/a&gt;), an open-source proxy for LLMs written in Rust. A few days ago we launched Arch-Router (&lt;a href=\\"https://huggingface.co/katanemo/Arch-Router-1.5B\\"&gt;https://huggingface.co/katanemo/Arch-Router-1.5B&lt;/a&gt;) on HuggingFace, a 1.5B router model designed for preference-aligned routing (and of course integrated in the proxy server). Full paper: &lt;a href=\\"https://arxiv.org/abs/2506.16655\\"&gt;https://arxiv.org/abs/2506.16655&lt;/a&gt;  &lt;/p&gt;\\n\\n&lt;p&gt;As teams integrate multiple LLMs - each with different strengths, styles, or cost/latency profiles — routing the right prompt to the right model becomes a critical part of the application design. But it’s still an open problem. Existing routing systems fall into two camps:&lt;/p&gt;\\n\\n&lt;ul&gt;\\n&lt;li&gt;&lt;strong&gt;Embedding-based or semantic routers&lt;/strong&gt; map the user’s prompt to a dense vector and route based on similarity — but they struggle in practice: they lack context awareness (so follow-ups like “And Boston?” are misrouted), fail to detect negation or logic (“I don’t want a refund” vs. “I want a refund”), miss rare or emerging intents that don’t form clear clusters, and can’t handle short, vague queries like “cancel” without added context.&lt;/li&gt;\\n&lt;li&gt;&lt;strong&gt;Performance-based routers&lt;/strong&gt; pick models based on benchmarks like MMLU or MT-Bench, or based on latency or cost curves. But benchmarks often miss what matters in production: domain-specific quality or subjective preferences especially as developers evaluate the effectiveness of their prompts against selected models.&lt;/li&gt;\\n&lt;/ul&gt;\\n\\n&lt;p&gt;Arch-Router takes a different approach: route by preferences written in plain language. You write rules like “contract clauses → GPT-4o” or “quick travel tips → Gemini Flash.” The router maps the prompt (and conversation context) to those rules using a lightweight 1.5B autoregressive model. No retraining, no fragile if/else chains. We built this with input from teams at Twilio and Atlassian. It handles intent drift, supports multi-turn conversations, and lets you swap in or out models with a one-line change to the routing policy. Full details are in our paper (&lt;a href=\\"https://arxiv.org/abs/2506.16655\\"&gt;https://arxiv.org/abs/2506.16655&lt;/a&gt;), but here’s a snapshot:&lt;/p&gt;\\n\\n&lt;p&gt;Specs:&lt;/p&gt;\\n\\n&lt;ul&gt;\\n&lt;li&gt;1.5B parameters — runs on a single GPU (or CPU for testing) &lt;/li&gt;\\n&lt;li&gt;No retraining needed — point it at any mix of LLMs&lt;/li&gt;\\n&lt;li&gt;Outperforms larger closed models on conversational routing benchmarks (details in the paper)&lt;/li&gt;\\n&lt;/ul&gt;\\n\\n&lt;p&gt;Hope you enjoy the paper, the model and the usage integrated via the proxy &lt;/p&gt;\\n&lt;/div&gt;&lt;!-- SC_ON --&gt;","likes":null,"suggested_sort":null,"banned_at_utc":null,"url_overridden_by_dest":"https://i.redd.it/dji5sexqsacf1.png","view_count":null,"archived":false,"no_follow":false,"is_crosspostable":false,"pinned":false,"over_18":false,"preview":{"images":[{"source":{"url":"https://preview.redd.it/dji5sexqsacf1.png?auto=webp&amp;s=6defb3e0fa7d637492925c1232be54f46adbd998","width":1724,"height":662},"resolutions":[{"url":"https://preview.redd.it/dji5sexqsacf1.png?width=108&amp;crop=smart&amp;auto=webp&amp;s=3002ab1e75571897ed7b3f677ff3e63c843da3b5","width":108,"height":41},{"url":"https://preview.redd.it/dji5sexqsacf1.png?width=216&amp;crop=smart&amp;auto=webp&amp;s=4e3d26c4ff36f1a326608bf09da7aacc08e394a5","width":216,"height":82},{"url":"https://preview.redd.it/dji5sexqsacf1.png?width=320&amp;crop=smart&amp;auto=webp&amp;s=a61d35cae21bda789c46f015f04cb3a885e9adf5","width":320,"height":122},{"url":"https://preview.redd.it/dji5sexqsacf1.png?width=640&amp;crop=smart&amp;auto=webp&amp;s=15a563260f80a5416899522519ec64978ae98380","width":640,"height":245},{"url":"https://preview.redd.it/dji5sexqsacf1.png?width=960&amp;crop=smart&amp;auto=webp&amp;s=7454f1af974a868861acb7e61a06f6c84520adbc","width":960,"height":368},{"url":"https://preview.redd.it/dji5sexqsacf1.png?width=1080&amp;crop=smart&amp;auto=webp&amp;s=1c5fd64591c27ebf7a8396c647d8ee21ee625161","width":1080,"height":414}],"variants":{},"id":"-6HAZRLyK6OYOwumT3UXaUsdgau9Oe0LXdGYsvFpsWg"}],"enabled":true},"all_awardings":[],"awarders":[],"media_only":false,"link_flair_template_id":"ced98442-f5d3-11ed-b657-66d3b15490c6","can_gild":false,"spoiler":false,"locked":false,"author_flair_text":null,"treatment_tags":[],"visited":false,"removed_by":null,"mod_note":null,"distinguished":null,"subreddit_id":"t5_81eyvm","author_is_blocked":false,"mod_reason_by":null,"num_reports":null,"removal_reason":null,"link_flair_background_color":"#ffb000","id":"1lxgm02","is_robot_indexable":true,"num_duplicates":0,"report_reasons":null,"author":"AdditionalWeb107","discussion_type":null,"num_comments":6,"send_replies":true,"media":null,"contest_mode":false,"author_patreon_flair":false,"author_flair_text_color":null,"permalink":"/r/LocalLLaMA/comments/1lxgm02/an_alternative_to_semantic_or_benchmarkbased/","stickied":false,"url":"https://i.redd.it/dji5sexqsacf1.png","subreddit_subscribers":498115,"created_utc":1752263600,"num_crossposts":0,"mod_reports":[],"is_video":false}}],"before":null}},{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"richtext","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":"d40ca12a-0e73-11ee-8563-f216e082168e","likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n2lyzci","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"AdditionalWeb107","can_mod_post":false,"created_utc":1752264285,"send_replies":true,"parent_id":"t1_n2lyrz0","score":2,"author_fullname":"t2_gwq7fd01b","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Would love the feedback. We'd be very open to learning from your testing experience. Thanks for saving.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n2lyzci","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Would love the feedback. We&amp;#39;d be very open to learning from your testing experience. Thanks for saving.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1lxgm02","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1lxgm02/an_alternative_to_semantic_or_benchmarkbased/n2lyzci/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752264285,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":2}}],"before":null}},"user_reports":[],"saved":false,"id":"n2lyrz0","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"LyPreto","can_mod_post":false,"created_utc":1752264224,"send_replies":true,"parent_id":"t3_1lxgm02","score":3,"author_fullname":"t2_walfb","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"I’ve been using my own hacked up router implementation and can’t get any reliable results under 3-7B models! saving this so i can try later!","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n2lyrz0","is_submitter":false,"downs":0,"author_flair_richtext":[{"e":"text","t":"Llama 2"}],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I’ve been using my own hacked up router implementation and can’t get any reliable results under 3-7B models! saving this so i can try later!&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":"light","score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1lxgm02/an_alternative_to_semantic_or_benchmarkbased/n2lyrz0/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752264224,"author_flair_text":"Llama 2","treatment_tags":[],"link_id":"t3_1lxgm02","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":"#ab96c2","collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":3}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n2mpezx","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"AdditionalWeb107","can_mod_post":false,"created_utc":1752272389,"send_replies":true,"parent_id":"t1_n2mhooa","score":1,"author_fullname":"t2_gwq7fd01b","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"The way performance-based routers work is that underneath the covers they'll have access to a weak/strong LLM (or a small subset of available models) and they'll train their router to optimize for MMLU or some other benchmark by building a reward function that tries to optimize for a single quality metric. Basically, they'll send a bunch of prompts to their router, generate responses from one of the underlying models, measure response quality on a public benchmark, and optimize to find the overall best fit for all queries that increases MMLU. In some cases, they'll take a cost threshold in training.\\n\\nBut the challenge is that performance is subjective and usually a trial/error scenario in an application setting. No one is measuring their application performance on public benchmarks, but instead they are creating their own evaluations of what different models can do for a particular scenario based on user and application requirements.   \\n  \\nArch-Router changed the training objective from benchmark performance optimization, to aligning to developer preferences by contextualizing a prompt and conversational history to match the underlying task the developer wants to be handled by a particular LLM: “quick travel tips → Gemini Flash\\" etc","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n2mpezx","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;The way performance-based routers work is that underneath the covers they&amp;#39;ll have access to a weak/strong LLM (or a small subset of available models) and they&amp;#39;ll train their router to optimize for MMLU or some other benchmark by building a reward function that tries to optimize for a single quality metric. Basically, they&amp;#39;ll send a bunch of prompts to their router, generate responses from one of the underlying models, measure response quality on a public benchmark, and optimize to find the overall best fit for all queries that increases MMLU. In some cases, they&amp;#39;ll take a cost threshold in training.&lt;/p&gt;\\n\\n&lt;p&gt;But the challenge is that performance is subjective and usually a trial/error scenario in an application setting. No one is measuring their application performance on public benchmarks, but instead they are creating their own evaluations of what different models can do for a particular scenario based on user and application requirements.   &lt;/p&gt;\\n\\n&lt;p&gt;Arch-Router changed the training objective from benchmark performance optimization, to aligning to developer preferences by contextualizing a prompt and conversational history to match the underlying task the developer wants to be handled by a particular LLM: “quick travel tips → Gemini Flash&amp;quot; etc&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1lxgm02","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1lxgm02/an_alternative_to_semantic_or_benchmarkbased/n2mpezx/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752272389,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n2mhooa","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Lazy-Pattern-5171","can_mod_post":false,"created_utc":1752269902,"send_replies":true,"parent_id":"t3_1lxgm02","score":1,"author_fullname":"t2_1lyjk8is25","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"How do they access model’s MMLU scores? Is it trained into their weights or they have some type of RAG + Tool calling. If so then doesn’t this just moves the problem from LLM to this gatekeeper LLM? Like now we have to determine if this LLM is worthy or not.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n2mhooa","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;How do they access model’s MMLU scores? Is it trained into their weights or they have some type of RAG + Tool calling. If so then doesn’t this just moves the problem from LLM to this gatekeeper LLM? Like now we have to determine if this LLM is worthy or not.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1lxgm02/an_alternative_to_semantic_or_benchmarkbased/n2mhooa/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752269902,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1lxgm02","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n2pfbm4","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Fristender","can_mod_post":false,"created_utc":1752315999,"send_replies":true,"parent_id":"t3_1lxgm02","score":1,"author_fullname":"t2_bya2blb7","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"Please enlighten me on the use cases. I always go for the most capable models even if they are costlier or 0.2 seconds slower.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n2pfbm4","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Please enlighten me on the use cases. I always go for the most capable models even if they are costlier or 0.2 seconds slower.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1lxgm02/an_alternative_to_semantic_or_benchmarkbased/n2pfbm4/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752315999,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1lxgm02","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}}]`),n=()=>e.jsx(t,{data:a});export{n as default};
