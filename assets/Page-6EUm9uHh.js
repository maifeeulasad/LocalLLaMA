import{j as e}from"./index-BgwOAK4-.js";import{R as t}from"./RedditPostRenderer-BOBjDTFu.js";import"./index-BL22wVg5.js";const a=JSON.parse(`[{"kind":"Listing","data":{"after":null,"dist":1,"modhash":"","geo_filter":"","children":[{"kind":"t3","data":{"approved_at_utc":null,"subreddit":"LocalLLaMA","selftext":"I have been trying various LLMs running locally (on a 64GB DDR4 Threadripper + 5090 box, on llama.cpp) to try to arrive at a co-maintainer for my established FOSS project.  I would like it to see the code and propose patches in diff (or direct to git by MCP) form.\\n\\nMy current theory is that the pressure to run quantized models is a major cause of why I can't get any model to produce a diff / patch that will apply to my project, they are all broken or slide off into gibberish or forgetfulness.  It's like a kind of pervasive brain damage.  At least, that is my hope, it may get disproved at any time by slop diffs coming out of a BF16 model.\\n\\nI am wondering if anyone has been able to run a large BF16 model successfully locally, or even remotely as a service, so I can assess whether my theory is just copium and it's all trash out there.\\n\\nThe next reachable step up for me seems to be an 8480ES + 512GB DDR5, but even this seems too small if the goal is to avoid quantization.\\n\\nI am reluctant to rent a H100 machine because I can only spend part of my time on this and the costs rack up all the time.\\n\\nA related difficulty is the context size, I guess most of the related sources can fit in 128K context, but this magnifies the compute needs accordingly.\\n\\nOpinions and experience welcome!","user_reports":[],"saved":false,"mod_reason_title":null,"gilded":0,"clicked":false,"title":"Escaping quantization brain damage with BF16?","link_flair_richtext":[{"e":"text","t":"Question | Help"}],"subreddit_name_prefixed":"r/LocalLLaMA","hidden":false,"pwls":6,"link_flair_css_class":"","downs":0,"thumbnail_height":null,"top_awarded_type":null,"hide_score":false,"name":"t3_1m3qg3w","quarantine":false,"link_flair_text_color":"dark","upvote_ratio":0.53,"author_flair_background_color":null,"subreddit_type":"public","ups":1,"total_awards_received":0,"media_embed":{},"thumbnail_width":null,"author_flair_template_id":null,"is_original_content":false,"author_fullname":"t2_z5dk4aa","secure_media":null,"is_reddit_media_domain":false,"is_meta":false,"category":null,"secure_media_embed":{},"link_flair_text":"Question | Help","can_mod_post":false,"score":1,"approved_by":null,"is_created_from_ads_ui":false,"author_premium":false,"thumbnail":"self","edited":false,"author_flair_css_class":null,"author_flair_richtext":[],"gildings":{},"content_categories":null,"is_self":true,"mod_note":null,"created":1752910988,"link_flair_type":"richtext","wls":6,"removed_by_category":null,"banned_by":null,"author_flair_type":"text","domain":"self.LocalLLaMA","allow_live_comments":false,"selftext_html":"&lt;!-- SC_OFF --&gt;&lt;div class=\\"md\\"&gt;&lt;p&gt;I have been trying various LLMs running locally (on a 64GB DDR4 Threadripper + 5090 box, on llama.cpp) to try to arrive at a co-maintainer for my established FOSS project.  I would like it to see the code and propose patches in diff (or direct to git by MCP) form.&lt;/p&gt;\\n\\n&lt;p&gt;My current theory is that the pressure to run quantized models is a major cause of why I can&amp;#39;t get any model to produce a diff / patch that will apply to my project, they are all broken or slide off into gibberish or forgetfulness.  It&amp;#39;s like a kind of pervasive brain damage.  At least, that is my hope, it may get disproved at any time by slop diffs coming out of a BF16 model.&lt;/p&gt;\\n\\n&lt;p&gt;I am wondering if anyone has been able to run a large BF16 model successfully locally, or even remotely as a service, so I can assess whether my theory is just copium and it&amp;#39;s all trash out there.&lt;/p&gt;\\n\\n&lt;p&gt;The next reachable step up for me seems to be an 8480ES + 512GB DDR5, but even this seems too small if the goal is to avoid quantization.&lt;/p&gt;\\n\\n&lt;p&gt;I am reluctant to rent a H100 machine because I can only spend part of my time on this and the costs rack up all the time.&lt;/p&gt;\\n\\n&lt;p&gt;A related difficulty is the context size, I guess most of the related sources can fit in 128K context, but this magnifies the compute needs accordingly.&lt;/p&gt;\\n\\n&lt;p&gt;Opinions and experience welcome!&lt;/p&gt;\\n&lt;/div&gt;&lt;!-- SC_ON --&gt;","likes":null,"suggested_sort":null,"banned_at_utc":null,"view_count":null,"archived":false,"no_follow":true,"is_crosspostable":false,"pinned":false,"over_18":false,"all_awardings":[],"awarders":[],"media_only":false,"link_flair_template_id":"2c9831e6-bf92-11ed-98e6-d2b8bcc02ae1","can_gild":false,"spoiler":false,"locked":false,"author_flair_text":null,"treatment_tags":[],"visited":false,"removed_by":null,"num_reports":null,"distinguished":null,"subreddit_id":"t5_81eyvm","author_is_blocked":false,"mod_reason_by":null,"removal_reason":null,"link_flair_background_color":"#5a74cc","id":"1m3qg3w","is_robot_indexable":true,"num_duplicates":0,"report_reasons":null,"author":"bitrumpled","discussion_type":null,"num_comments":55,"send_replies":true,"media":null,"contest_mode":false,"author_patreon_flair":false,"author_flair_text_color":null,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/","stickied":false,"url":"https://www.reddit.com/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/","subreddit_subscribers":501753,"created_utc":1752910988,"num_crossposts":0,"mod_reports":[],"is_video":false}}],"before":null}},{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n41v2ax","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"RhubarbSimilar1683","can_mod_post":false,"send_replies":true,"parent_id":"t1_n40d7mz","score":3,"author_fullname":"t2_1k4sjdwzk2","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"That's because most here don't have a master's in ml or ai and think that more bits is better. ","edited":false,"top_awarded_type":null,"downs":0,"author_flair_css_class":null,"name":"t1_n41v2ax","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;That&amp;#39;s because most here don&amp;#39;t have a master&amp;#39;s in ml or ai and think that more bits is better. &lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41v2ax/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752955880,"author_flair_text":null,"treatment_tags":[],"created_utc":1752955880,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":2,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":3}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n4316gt","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"z_3454_pfk","can_mod_post":false,"send_replies":true,"parent_id":"t1_n40d7mz","score":1,"author_fullname":"t2_askwa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"my understanding was that by saying ‘slop diffs’ and referring to bf16, he was talking about bf16 quantisation of a fp32 model. not everyone is running common models and we have no idea what he is running, so fp32 models (even old ones) could be what he was referring to. you’re right in saying the layer normalization is kept at fp32 tho. and fp4 training is also making a lot of progress.","edited":false,"top_awarded_type":null,"downs":0,"author_flair_css_class":null,"name":"t1_n4316gt","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;my understanding was that by saying ‘slop diffs’ and referring to bf16, he was talking about bf16 quantisation of a fp32 model. not everyone is running common models and we have no idea what he is running, so fp32 models (even old ones) could be what he was referring to. you’re right in saying the layer normalization is kept at fp32 tho. and fp4 training is also making a lot of progress.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n4316gt/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752970274,"author_flair_text":null,"treatment_tags":[],"created_utc":1752970274,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":2,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n40d7mz","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":false,"author":"eloquentemu","can_mod_post":false,"created_utc":1752938935,"send_replies":true,"parent_id":"t1_n3ylegp","score":4,"author_fullname":"t2_lpdsy","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"This is a very confusing post to me, especially as the highest voted answer.  \\"full fp32 weights\\"?  What model has been trained in fp32?  They are almost all trained at bf16 with the exceptions being fp8 rather than fp32.\\n\\n(I guess _technically_ some smaller tensors will be fp32, but they are not usually what we talk about and are often left fp32 even in quantized models.)","edited":1752943052,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n40d7mz","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;This is a very confusing post to me, especially as the highest voted answer.  &amp;quot;full fp32 weights&amp;quot;?  What model has been trained in fp32?  They are almost all trained at bf16 with the exceptions being fp8 rather than fp32.&lt;/p&gt;\\n\\n&lt;p&gt;(I guess &lt;em&gt;technically&lt;/em&gt; some smaller tensors will be fp32, but they are not usually what we talk about and are often left fp32 even in quantized models.)&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n40d7mz/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752938935,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":4}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n42a3rh","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"RhubarbSimilar1683","can_mod_post":false,"send_replies":true,"parent_id":"t1_n40rs1b","score":2,"author_fullname":"t2_1k4sjdwzk2","approved_by":null,"mod_note":null,"all_awardings":[],"body":"You are literally reinforcing your own theory using an LLM. Why don't you test this theory with Deepseek which is fp8 and online, and compare it to your other tests? Pretty much all SOTA models are fp8, why don't you run tests on ChatGPT and Gemini? ","edited":1752961112,"gildings":{},"downs":0,"author_flair_css_class":null,"name":"t1_n42a3rh","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;You are literally reinforcing your own theory using an LLM. Why don&amp;#39;t you test this theory with Deepseek which is fp8 and online, and compare it to your other tests? Pretty much all SOTA models are fp8, why don&amp;#39;t you run tests on ChatGPT and Gemini? &lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n42a3rh/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752960800,"author_flair_text":null,"treatment_tags":[],"created_utc":1752960800,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":5,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":2}}],"before":null}},"user_reports":[],"saved":false,"id":"n40rs1b","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n40qg3o","score":1,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Here's a conversation I had with Kimi-latest thismorning on the topic you're 'baffled' about:\\n\\n&gt;&gt; I would like to selfhost you to help me create patches. Do you think this is feasible on a heavily-quantized version?\\n\\n&gt; Short answer: probably not.\\n&gt; A really small (&lt;4-bit) quantized model loses the reasoning capacity you need for “understand this 10-year-old C codebase, figure out what the bug really is, and emit a correct patch”. Even a 70 B @ 4-bit model will forget your exact coding rules, mis-understand the interaction with the event loop, or hallucinate an API that never existed. You’d end up spending more time hand-reviewing bad suggestions than you saved.\\n...","edited":false,"author_flair_css_class":null,"name":"t1_n40rs1b","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Here&amp;#39;s a conversation I had with Kimi-latest thismorning on the topic you&amp;#39;re &amp;#39;baffled&amp;#39; about:&lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;blockquote&gt;\\n&lt;p&gt;I would like to selfhost you to help me create patches. Do you think this is feasible on a heavily-quantized version?&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;Short answer: probably not.\\nA really small (&amp;lt;4-bit) quantized model loses the reasoning capacity you need for “understand this 10-year-old C codebase, figure out what the bug really is, and emit a correct patch”. Even a 70 B @ 4-bit model will forget your exact coding rules, mis-understand the interaction with the event loop, or hallucinate an API that never existed. You’d end up spending more time hand-reviewing bad suggestions than you saved.\\n...&lt;/p&gt;\\n&lt;/blockquote&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"treatment_tags":[],"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n40rs1b/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752943487,"author_flair_text":null,"collapsed":false,"created_utc":1752943487,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":4,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n419ohx","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n40za6y","score":1,"author_fullname":"t2_z5dk4aa","approved_by":null,"mod_note":null,"all_awardings":[],"body":"Hm... lot of negative, attacking response from yourself.\\n\\nHave a nice rest of your day.","edited":false,"gildings":{},"downs":0,"author_flair_css_class":null,"name":"t1_n419ohx","is_submitter":true,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Hm... lot of negative, attacking response from yourself.&lt;/p&gt;\\n\\n&lt;p&gt;Have a nice rest of your day.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n419ohx/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752948977,"author_flair_text":null,"treatment_tags":[],"created_utc":1752948977,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":5,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n40za6y","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"eloquentemu","can_mod_post":false,"send_replies":true,"parent_id":"t1_n40qg3o","score":1,"author_fullname":"t2_lpdsy","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"&gt; if you use increasingly aggressive quantization, mistakes increase, right? \\n\\nI don't think this is accurate.  Sure, going from bf16 to Q1 will destroy a model, but bf16 to Q8?  It's actually debatable.  Like, when people run benchmarks the Q8 will sometimes perform better in some areas and worse in others.  So while quantization does change a model, it's not simple to say how much, if at all, worse it ends up - at least to point which is very roughly Q4 depending on the model.  You are welcome to look up benchmarks that people have done.  [E.g.](https://page.genspark.site/page/toolu_018LCdFVi8w6aXChyMqERMdx/revised_quantization_performance_analysis.html)\\n\\n&gt; If \\"unquantized\\" is Q8\\n\\nIt's not Q8, it's fp8.  While both use 8 bits, fp8 is floating point while Q8 is integer... depending on the specific fp8 the range of values it represents is +/- 448 or +/- 57344 while Q8 is +/- 127.  Well, kind of since Q8 has a per-block scale so it's not really a simple comparison so you get the point\\n\\n&gt; I don't understand then why there are multiple BF16 versions of say Kimi-2 at huggingface\\n\\nAs mentioned, most people can't run fp8 due to inference engine limitations.  Indeed, llama.cpp can't even convert to/from fp8 so you need a bf16 version (which is lossless from fp8, unlike Q8) in order to quantize it or run it.\\n\\n&gt; Humans would edit files / capture changes in a patch / apply patch in git selectively. What does the flow look like step by step for the model, in the flow you are suggesting? It emits whole files with the new content? I tried this flow previously and it is also very shaky, including // rest of file goes here from the model\\n\\nHeck yeah it's shaky.  As I said: \\"getting models to provide usable code is already kind of borderline\\".  This is why a lot of companies are working on and selling AI *dev tools* rather than models.  Models might be able to generate or debug a function (or even one-shot a reasonably functional small project) but they can't maintain a code base without external tooling (and realistically human guidance).  To this end, \`git diff\` and the model itself are only small pieces of a much larger solution.  \\n\\n&gt; No offense but with so many negative superlatives, you are sounding a bit fragile.\\n\\nHaha, no offense but you sound like you have no idea what you are talking about and are upset that you're being corrected... or maybe having your baseless expectations of models being challenged?  I must confess that it's a strange mindset to get repeated failures but when being told you're talking the wrong approach you do a \\"Am I out of touch? / No, it's the children who are ~~wrong~~ fragile\\".  You don't understand fp8 vs Q8 and want to push your theory about quantization killing models on a task with 0 proof?  Whatever.  Maybe stop listening to ChatGPT when it tells you all your ideas are smart and innovative.","edited":false,"author_flair_css_class":null,"name":"t1_n40za6y","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;blockquote&gt;\\n&lt;p&gt;if you use increasingly aggressive quantization, mistakes increase, right? &lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;I don&amp;#39;t think this is accurate.  Sure, going from bf16 to Q1 will destroy a model, but bf16 to Q8?  It&amp;#39;s actually debatable.  Like, when people run benchmarks the Q8 will sometimes perform better in some areas and worse in others.  So while quantization does change a model, it&amp;#39;s not simple to say how much, if at all, worse it ends up - at least to point which is very roughly Q4 depending on the model.  You are welcome to look up benchmarks that people have done.  &lt;a href=\\"https://page.genspark.site/page/toolu_018LCdFVi8w6aXChyMqERMdx/revised_quantization_performance_analysis.html\\"&gt;E.g.&lt;/a&gt;&lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;p&gt;If &amp;quot;unquantized&amp;quot; is Q8&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;It&amp;#39;s not Q8, it&amp;#39;s fp8.  While both use 8 bits, fp8 is floating point while Q8 is integer... depending on the specific fp8 the range of values it represents is +/- 448 or +/- 57344 while Q8 is +/- 127.  Well, kind of since Q8 has a per-block scale so it&amp;#39;s not really a simple comparison so you get the point&lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;p&gt;I don&amp;#39;t understand then why there are multiple BF16 versions of say Kimi-2 at huggingface&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;As mentioned, most people can&amp;#39;t run fp8 due to inference engine limitations.  Indeed, llama.cpp can&amp;#39;t even convert to/from fp8 so you need a bf16 version (which is lossless from fp8, unlike Q8) in order to quantize it or run it.&lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;p&gt;Humans would edit files / capture changes in a patch / apply patch in git selectively. What does the flow look like step by step for the model, in the flow you are suggesting? It emits whole files with the new content? I tried this flow previously and it is also very shaky, including // rest of file goes here from the model&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;Heck yeah it&amp;#39;s shaky.  As I said: &amp;quot;getting models to provide usable code is already kind of borderline&amp;quot;.  This is why a lot of companies are working on and selling AI &lt;em&gt;dev tools&lt;/em&gt; rather than models.  Models might be able to generate or debug a function (or even one-shot a reasonably functional small project) but they can&amp;#39;t maintain a code base without external tooling (and realistically human guidance).  To this end, &lt;code&gt;git diff&lt;/code&gt; and the model itself are only small pieces of a much larger solution.  &lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;p&gt;No offense but with so many negative superlatives, you are sounding a bit fragile.&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;Haha, no offense but you sound like you have no idea what you are talking about and are upset that you&amp;#39;re being corrected... or maybe having your baseless expectations of models being challenged?  I must confess that it&amp;#39;s a strange mindset to get repeated failures but when being told you&amp;#39;re talking the wrong approach you do a &amp;quot;Am I out of touch? / No, it&amp;#39;s the children who are &lt;del&gt;wrong&lt;/del&gt; fragile&amp;quot;.  You don&amp;#39;t understand fp8 vs Q8 and want to push your theory about quantization killing models on a task with 0 proof?  Whatever.  Maybe stop listening to ChatGPT when it tells you all your ideas are smart and innovative.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"treatment_tags":[],"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n40za6y/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752945780,"author_flair_text":null,"collapsed":false,"created_utc":1752945780,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":4,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n40qg3o","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n40gf0k","score":1,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"&gt; I remain baffled as to why you think\\n\\n... if you use increasingly aggressive quantization, mistakes increase, right?  So it will be good to see what performance is like without quantization.  If it's still just as broken then okay, it's not caused by quantization.  No problem doing science on it, right?\\n\\nIf \\"unquantized\\" is Q8, fine, but I don't understand then why there are multiple BF16 versions of say Kimi-2 at huggingface https://huggingface.co/unsloth/Kimi-K2-Instruct-GGUF?show_file_info=BF16%2FKimi-K2-Instruct-BF16-00001-of-00045.gguf\\n\\n&gt;  But you want to model to write a diff directly?\\n\\nYeah.  If I had a person as a coding assistant, what I want it to do is give me a patch to look at.  I don't need them to write it linearly, I expect them to use an editor and give me a patch or git diff of their changes.  Am I strange or is that not how the entire software world works?\\n\\n&gt; But the need is also really questionable to me too.\\n\\nNo offense but with so many negative superlatives, you are sounding a bit fragile.\\n\\n&gt; Just have a model update the code in a separate clone of the repo. \\n\\nSo... how will it do that?  Humans would edit files / capture changes in a patch / apply patch in git selectively.  What does the flow look like step by step for the model, in the flow you are suggesting?  It emits whole files with the new content?  I tried this flow previously and it is also very shaky, including \`// rest of file goes here\` from the model","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n40qg3o","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;blockquote&gt;\\n&lt;p&gt;I remain baffled as to why you think&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;... if you use increasingly aggressive quantization, mistakes increase, right?  So it will be good to see what performance is like without quantization.  If it&amp;#39;s still just as broken then okay, it&amp;#39;s not caused by quantization.  No problem doing science on it, right?&lt;/p&gt;\\n\\n&lt;p&gt;If &amp;quot;unquantized&amp;quot; is Q8, fine, but I don&amp;#39;t understand then why there are multiple BF16 versions of say Kimi-2 at huggingface &lt;a href=\\"https://huggingface.co/unsloth/Kimi-K2-Instruct-GGUF?show_file_info=BF16%2FKimi-K2-Instruct-BF16-00001-of-00045.gguf\\"&gt;https://huggingface.co/unsloth/Kimi-K2-Instruct-GGUF?show_file_info=BF16%2FKimi-K2-Instruct-BF16-00001-of-00045.gguf&lt;/a&gt;&lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;p&gt;But you want to model to write a diff directly?&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;Yeah.  If I had a person as a coding assistant, what I want it to do is give me a patch to look at.  I don&amp;#39;t need them to write it linearly, I expect them to use an editor and give me a patch or git diff of their changes.  Am I strange or is that not how the entire software world works?&lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;p&gt;But the need is also really questionable to me too.&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;No offense but with so many negative superlatives, you are sounding a bit fragile.&lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;p&gt;Just have a model update the code in a separate clone of the repo. &lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;So... how will it do that?  Humans would edit files / capture changes in a patch / apply patch in git selectively.  What does the flow look like step by step for the model, in the flow you are suggesting?  It emits whole files with the new content?  I tried this flow previously and it is also very shaky, including &lt;code&gt;// rest of file goes here&lt;/code&gt; from the model&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n40qg3o/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752943063,"author_flair_text":null,"treatment_tags":[],"created_utc":1752943063,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":3,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n40gf0k","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"eloquentemu","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3ymd00","score":1,"author_fullname":"t2_lpdsy","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"&gt; Since eg Kimi-2 is 2TB at BF16\\n\\nFWIW Kimi-K2 (and Deepseek 671B) are actually fp8 models.  This is of limited relevance to r/LocalLLaMA as there are (AFAIK) no engines that support running them as fp8 on CPU and 1TB of VRAM is expensive to own :)\\n\\n&gt; at different quantizations, none of them could produce usable output\\n\\nI remain baffled as to why you think this is a quantization error issue and not a model limitation.  Like, getting models to provide usable code is already kind of borderline.  But you want to model to write a diff directly?  How many humans do you know that can do that?  Look at a piece of code and just bang out a \`.diff\` that actually applies?  Personally, I have a hard enough time just updating an existing \`.diff\` because of needing to get the line numbers just-so.\\n\\nBut the need is also really questionable to me too.  It's not like humans use this workflow.  Just have a model update the code in a separate clone of the repo.  Then use the normal git workflow to push a PR.  Models can handle all these steps smoothly - write code, write PR, etc.  Not to mention by having the full updated code available you can run tests and pipe and build or test failures back to the model.","edited":false,"top_awarded_type":null,"downs":0,"author_flair_css_class":null,"name":"t1_n40gf0k","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;blockquote&gt;\\n&lt;p&gt;Since eg Kimi-2 is 2TB at BF16&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;FWIW Kimi-K2 (and Deepseek 671B) are actually fp8 models.  This is of limited relevance to &lt;a href=\\"/r/LocalLLaMA\\"&gt;r/LocalLLaMA&lt;/a&gt; as there are (AFAIK) no engines that support running them as fp8 on CPU and 1TB of VRAM is expensive to own :)&lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;p&gt;at different quantizations, none of them could produce usable output&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;I remain baffled as to why you think this is a quantization error issue and not a model limitation.  Like, getting models to provide usable code is already kind of borderline.  But you want to model to write a diff directly?  How many humans do you know that can do that?  Look at a piece of code and just bang out a &lt;code&gt;.diff&lt;/code&gt; that actually applies?  Personally, I have a hard enough time just updating an existing &lt;code&gt;.diff&lt;/code&gt; because of needing to get the line numbers just-so.&lt;/p&gt;\\n\\n&lt;p&gt;But the need is also really questionable to me too.  It&amp;#39;s not like humans use this workflow.  Just have a model update the code in a separate clone of the repo.  Then use the normal git workflow to push a PR.  Models can handle all these steps smoothly - write code, write PR, etc.  Not to mention by having the full updated code available you can run tests and pipe and build or test failures back to the model.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n40gf0k/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752939916,"author_flair_text":null,"treatment_tags":[],"created_utc":1752939916,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":2,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3ymd00","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":"LOW_SCORE","no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752912320,"send_replies":true,"parent_id":"t1_n3ylegp","score":-6,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"I have tried a variety of models (llama-3, llama-4, some forms of Qwen, some forms of Gemini) at different quantizations, none of them could produce usable output, so I am open to recommendations from the angle of what I could run at BF16.\\n\\nSince eg Kimi-2 is 2TB at BF16, I am afraid trying BF 16 with a large model is going to need a different approach with the kind of hw.  So I am asking about how to come at that as much as choosing which model.\\n\\n(I am also guessing most of the services offering to talk to the models are actually quite heavily quantized rather than running at BF16, none of them seem to explain the quantization level of the model you are actually talking to.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3ymd00","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I have tried a variety of models (llama-3, llama-4, some forms of Qwen, some forms of Gemini) at different quantizations, none of them could produce usable output, so I am open to recommendations from the angle of what I could run at BF16.&lt;/p&gt;\\n\\n&lt;p&gt;Since eg Kimi-2 is 2TB at BF16, I am afraid trying BF 16 with a large model is going to need a different approach with the kind of hw.  So I am asking about how to come at that as much as choosing which model.&lt;/p&gt;\\n\\n&lt;p&gt;(I am also guessing most of the services offering to talk to the models are actually quite heavily quantized rather than running at BF16, none of them seem to explain the quantization level of the model you are actually talking to.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":"comment score below threshold","distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3ymd00/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752912320,"author_flair_text":null,"treatment_tags":[],"collapsed":true,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":-6}}],"before":null}},"user_reports":[],"saved":false,"id":"n3ylegp","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":false,"author":"z_3454_pfk","can_mod_post":false,"created_utc":1752911789,"send_replies":true,"parent_id":"t3_1m3qg3w","score":10,"author_fullname":"t2_askwa","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"bf16 produces very little degradation compared to full fp32 weights. some models are more sensitive to quantization then others. you never mentioned which model you’re using.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3ylegp","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;bf16 produces very little degradation compared to full fp32 weights. some models are more sensitive to quantization then others. you never mentioned which model you’re using.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3ylegp/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752911789,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":10}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n41vi3m","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"greentheonly","can_mod_post":false,"send_replies":true,"parent_id":"t1_n401rkg","score":1,"author_fullname":"t2_3rrw4qm","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"&gt;  I don't have a charitable explanation why I keep reading about people including AI in their workflow and having a great time.\\n\\n1. marketing\\n2. you never specified your language of choice. some things like python/and various webdev stuff are better.\\n\\nAnd yes, I've run bf16 and it's the same hit and miss. Just like the poster above said, the models cannot actually do a real unified diff for the most part for a variety of reasons, so various tooling like aider and such has coping strategies like \\"Whole file\\" or kinda-sorta-forgetting diff.\\n\\n&gt; BF16 doesn't actually work any better\\n\\nIt does work better in vrious ways, just not enough for it to matter for this particular usecase","edited":false,"author_flair_css_class":null,"name":"t1_n41vi3m","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;blockquote&gt;\\n&lt;p&gt;I don&amp;#39;t have a charitable explanation why I keep reading about people including AI in their workflow and having a great time.&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;ol&gt;\\n&lt;li&gt;marketing&lt;/li&gt;\\n&lt;li&gt;you never specified your language of choice. some things like python/and various webdev stuff are better.&lt;/li&gt;\\n&lt;/ol&gt;\\n\\n&lt;p&gt;And yes, I&amp;#39;ve run bf16 and it&amp;#39;s the same hit and miss. Just like the poster above said, the models cannot actually do a real unified diff for the most part for a variety of reasons, so various tooling like aider and such has coping strategies like &amp;quot;Whole file&amp;quot; or kinda-sorta-forgetting diff.&lt;/p&gt;\\n\\n&lt;blockquote&gt;\\n&lt;p&gt;BF16 doesn&amp;#39;t actually work any better&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;It does work better in vrious ways, just not enough for it to matter for this particular usecase&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"treatment_tags":[],"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41vi3m/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752956022,"author_flair_text":null,"collapsed":false,"created_utc":1752956022,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":4,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n401rkg","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3zpxks","score":1,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"You did try BF16?  What did you try to get BF16 to do?\\n\\nAs I say to date, my experience is the same.  If BF16 doesn't actually work any better I don't have a charitable explanation why I keep reading about people including AI in their workflow and having a great time.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n401rkg","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;You did try BF16?  What did you try to get BF16 to do?&lt;/p&gt;\\n\\n&lt;p&gt;As I say to date, my experience is the same.  If BF16 doesn&amp;#39;t actually work any better I don&amp;#39;t have a charitable explanation why I keep reading about people including AI in their workflow and having a great time.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n401rkg/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752935359,"author_flair_text":null,"treatment_tags":[],"created_utc":1752935359,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":3,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3zpxks","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"And-Bee","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3zgesl","score":1,"author_fullname":"t2_a81fjhk","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"I even tried closed source. None could do it. Can you suggest one?","edited":false,"top_awarded_type":null,"downs":0,"author_flair_css_class":null,"name":"t1_n3zpxks","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I even tried closed source. None could do it. Can you suggest one?&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3zpxks/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752931346,"author_flair_text":null,"treatment_tags":[],"created_utc":1752931346,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":2,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3zgesl","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752927726,"send_replies":true,"parent_id":"t1_n3zf7da","score":0,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Thanks, today, I would say the same.  But I am guessing, none of the models you tried were in BF16?  I am wondering if the problems with diffs are coming from the quantization and not the model, that is why I want to try the same tests on a BF16 model.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3zgesl","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Thanks, today, I would say the same.  But I am guessing, none of the models you tried were in BF16?  I am wondering if the problems with diffs are coming from the quantization and not the model, that is why I want to try the same tests on a BF16 model.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3zgesl/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752927726,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":0}}],"before":null}},"user_reports":[],"saved":false,"id":"n3zf7da","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":false,"author":"And-Bee","can_mod_post":false,"created_utc":1752927223,"send_replies":true,"parent_id":"t3_1m3qg3w","score":4,"author_fullname":"t2_a81fjhk","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"I can’t get any model to produce any diff/patch that works. I think tools like cline get around this by getting the model to add tags in the code to do search and replace, otherwise you need to feed the model the code with line numbers so it knows which lines it can modify, adding a lot to the context length.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3zf7da","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I can’t get any model to produce any diff/patch that works. I think tools like cline get around this by getting the model to add tags in the code to do search and replace, otherwise you need to feed the model the code with line numbers so it knows which lines it can modify, adding a lot to the context length.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3zf7da/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752927223,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":4}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n40vanj","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752944580,"send_replies":true,"parent_id":"t1_n40tp17","score":1,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Yes, my idea is try get some kind of result with my existing box.  Failing that, burn a little money renting a box and preparing scripts so doing it again is faster, and try to prove it can do something useful, or disprove my hope - it's not a belief - that things will be better without quantization.  Lastly, only if results are good, try to run it on better hardware here.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n40vanj","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Yes, my idea is try get some kind of result with my existing box.  Failing that, burn a little money renting a box and preparing scripts so doing it again is faster, and try to prove it can do something useful, or disprove my hope - it&amp;#39;s not a belief - that things will be better without quantization.  Lastly, only if results are good, try to run it on better hardware here.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n40vanj/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752944580,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n40tp17","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"MikeRoz","can_mod_post":false,"created_utc":1752944084,"send_replies":true,"parent_id":"t3_1m3qg3w","score":2,"author_fullname":"t2_ht2fg","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"&gt; I am reluctant to rent a H100 machine because I can only spend part of my time on this and the costs rack up all the time.\\n\\n\\n\\nWhy not carve out some time to run BF16 models on such a machine or a RunPod node with multiple such GPUs, and see if running in BF16 solves the problem you think it will? $65 for 12 hours with such a machine is surely going to cost less than the 8480ES + 512GB DDR5 machine you mention, and you'll avoid the risk of buying the machine only to find you were wrong. If you find that BF16 solves your problems, you'll know that building a local machine with more RAM/VRAM will be productive for you - though it's probably going to perform quite a bit worse unless you shell out for those same H100s.\\n\\n\\nAlso, how large is your project? You talk about all the required source fitting in 128k context, but common wisdom seems to be that most models degrade beyond 32k context. Do responses become more coherent if you provide only part of the project in context?","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n40tp17","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;blockquote&gt;\\n&lt;p&gt; I am reluctant to rent a H100 machine because I can only spend part of my time on this and the costs rack up all the time.&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;Why not carve out some time to run BF16 models on such a machine or a RunPod node with multiple such GPUs, and see if running in BF16 solves the problem you think it will? $65 for 12 hours with such a machine is surely going to cost less than the 8480ES + 512GB DDR5 machine you mention, and you&amp;#39;ll avoid the risk of buying the machine only to find you were wrong. If you find that BF16 solves your problems, you&amp;#39;ll know that building a local machine with more RAM/VRAM will be productive for you - though it&amp;#39;s probably going to perform quite a bit worse unless you shell out for those same H100s.&lt;/p&gt;\\n\\n&lt;p&gt;Also, how large is your project? You talk about all the required source fitting in 128k context, but common wisdom seems to be that most models degrade beyond 32k context. Do responses become more coherent if you provide only part of the project in context?&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n40tp17/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752944084,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":2}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n3z9tyg","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"ravage382","can_mod_post":false,"created_utc":1752924938,"send_replies":true,"parent_id":"t3_1m3qg3w","score":1,"author_fullname":"t2_9sf41","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"Devstal in q8 has done the best for local coding tasks for me.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3z9tyg","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Devstal in q8 has done the best for local coding tasks for me.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z9tyg/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752924938,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n3zjgx4","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"johnkapolos","can_mod_post":false,"created_utc":1752928947,"send_replies":true,"parent_id":"t3_1m3qg3w","score":1,"author_fullname":"t2_te4dl","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"Rent a big machine in vast or some other cheap provider for a couple of hours. Test your hypothesis, done.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3zjgx4","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Rent a big machine in vast or some other cheap provider for a couple of hours. Test your hypothesis, done.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3zjgx4/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752928947,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n41cdgf","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752949845,"send_replies":true,"parent_id":"t1_n40ygit","score":1,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"No problems doing what though?  I also can run Q4 models for many things, you could say 'successfully' for some values of success, but I have not been able to find one that can produce diffs on a large codebase sanely, and it seems I am not alone.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n41cdgf","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;No problems doing what though?  I also can run Q4 models for many things, you could say &amp;#39;successfully&amp;#39; for some values of success, but I have not been able to find one that can produce diffs on a large codebase sanely, and it seems I am not alone.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41cdgf/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752949845,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n40ygit","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"triynizzles1","can_mod_post":false,"created_utc":1752945532,"send_replies":true,"parent_id":"t3_1m3qg3w","score":1,"author_fullname":"t2_zr0g49ixt","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"I’ve pretty much always ran Q4 and never had any problems. The symptoms you are describing seem to indicate you have exceeded your context window. I haven’t use llama CPP before, but I imagine in some capacity you will need to specify what size context window you want or else it will run at a predetermined default size.\\n\\nSome AI models will truncate their KV cache when the context window is exceeded, basically removing a bunch of the conversation history leading to nonsense outputs.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n40ygit","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I’ve pretty much always ran Q4 and never had any problems. The symptoms you are describing seem to indicate you have exceeded your context window. I haven’t use llama CPP before, but I imagine in some capacity you will need to specify what size context window you want or else it will run at a predetermined default size.&lt;/p&gt;\\n\\n&lt;p&gt;Some AI models will truncate their KV cache when the context window is exceeded, basically removing a bunch of the conversation history leading to nonsense outputs.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n40ygit/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752945532,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n4265mp","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Awwtifishal","can_mod_post":false,"send_replies":true,"parent_id":"t1_n41zni0","score":1,"author_fullname":"t2_1d96a8k10t","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"I was talking about the case where you have e.g. 30 files and only 4 are actually relevant. Even if it underperforms and only lists 10 of the files that are unrelated, that's already an improvement because you can shove off a third of the context before getting an answer.\\n\\nIf you try what I suggest (asking for the diff only \\\\*after\\\\* they have performed the changes) and you still have trouble, something that may work well is to number the lines of the source files (at least when asking for a diff). I.e. make the request without the line numbers and after it has answered, modify the message to include the line numbers, as if you did ask for it already with the line numbers, and include the answer from which it can make the diff. Remember that in each request you're sending the whole conversation, and you can freely modify it (both your side and the AI's side) after the fact, before sending another request.","edited":false,"author_flair_css_class":null,"name":"t1_n4265mp","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I was talking about the case where you have e.g. 30 files and only 4 are actually relevant. Even if it underperforms and only lists 10 of the files that are unrelated, that&amp;#39;s already an improvement because you can shove off a third of the context before getting an answer.&lt;/p&gt;\\n\\n&lt;p&gt;If you try what I suggest (asking for the diff only *after* they have performed the changes) and you still have trouble, something that may work well is to number the lines of the source files (at least when asking for a diff). I.e. make the request without the line numbers and after it has answered, modify the message to include the line numbers, as if you did ask for it already with the line numbers, and include the answer from which it can make the diff. Remember that in each request you&amp;#39;re sending the whole conversation, and you can freely modify it (both your side and the AI&amp;#39;s side) after the fact, before sending another request.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"treatment_tags":[],"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n4265mp/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752959498,"author_flair_text":null,"collapsed":false,"created_utc":1752959498,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":4,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n41zni0","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n41w81s","score":1,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"Yes in my tests until now I start a new empty context each time.  Model performance was awful when I left previous back-and-forth in the context and got steadily worse, as you say it has finite attention and it attended to things that were basically its misunderstandings from last time.  So now I completely restart each time modifying the prompt slightly.\\n\\nSome models were very close to producing usable diffs, with accurate line count headers.  But they lost their way and essentially forgot what they were doing partway through.\\n\\nFor my test case, it only modifies one file, which I send with the prompt, so I don't need to get it to suggest a file list, if it works (how does it know from cold what files are available and what's in them?) it would be a good idea.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n41zni0","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Yes in my tests until now I start a new empty context each time.  Model performance was awful when I left previous back-and-forth in the context and got steadily worse, as you say it has finite attention and it attended to things that were basically its misunderstandings from last time.  So now I completely restart each time modifying the prompt slightly.&lt;/p&gt;\\n\\n&lt;p&gt;Some models were very close to producing usable diffs, with accurate line count headers.  But they lost their way and essentially forgot what they were doing partway through.&lt;/p&gt;\\n\\n&lt;p&gt;For my test case, it only modifies one file, which I send with the prompt, so I don&amp;#39;t need to get it to suggest a file list, if it works (how does it know from cold what files are available and what&amp;#39;s in them?) it would be a good idea.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41zni0/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752957373,"author_flair_text":null,"treatment_tags":[],"created_utc":1752957373,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":3,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n41w81s","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Awwtifishal","can_mod_post":false,"send_replies":true,"parent_id":"t1_n41ud4l","score":1,"author_fullname":"t2_1d96a8k10t","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Ok, you can try this: Ask for the changes (in whatever format the model wants), then ask to make a diff file with those changes, and finally change the messages to replace the changes by just the diffs (or simply delete the messages that asks for and answers with the diff) to reduce the context before continuing with the next file.\\n\\nIn general, when you want the model to do several things, it performs better if you ask one at a time. Then you can change the context to reduce its usage.\\n\\nAnother strategy to save in context is to ask it for a list of files that are completely unrelated to the changes you asked for, and then re-submit the request removing the unneeded files.","edited":false,"top_awarded_type":null,"downs":0,"author_flair_css_class":null,"name":"t1_n41w81s","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Ok, you can try this: Ask for the changes (in whatever format the model wants), then ask to make a diff file with those changes, and finally change the messages to replace the changes by just the diffs (or simply delete the messages that asks for and answers with the diff) to reduce the context before continuing with the next file.&lt;/p&gt;\\n\\n&lt;p&gt;In general, when you want the model to do several things, it performs better if you ask one at a time. Then you can change the context to reduce its usage.&lt;/p&gt;\\n\\n&lt;p&gt;Another strategy to save in context is to ask it for a list of files that are completely unrelated to the changes you asked for, and then re-submit the request removing the unneeded files.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41w81s/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752956255,"author_flair_text":null,"treatment_tags":[],"created_utc":1752956255,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":2,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n41ud4l","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752955656,"send_replies":true,"parent_id":"t1_n41qyyx","score":1,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"I want diffs because I can directly judge / read and consume them into git, and I can work with them immediately.  I have tried asking for full files, on the basis I can externally diff them, but for my 6.5K token example, the Q4 models were very reluctant to do it, I literally got variations on \\\\\`// rest of source file here\\\\\` rather than spilling the file.  Maybe the Q8 one will do better when I try it.\\n\\nIf the patch touches several large files, this also makes it liable to overflow the context bringing in and emitting multiple whole files; if the model changes 1 line in a 6.5K token file it has to take in and emit 13K tokens, whereas with a diff it's much smaller.  For this reason, failures of the model aside, diffs seem to be the natural currency for this.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n41ud4l","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I want diffs because I can directly judge / read and consume them into git, and I can work with them immediately.  I have tried asking for full files, on the basis I can externally diff them, but for my 6.5K token example, the Q4 models were very reluctant to do it, I literally got variations on \`// rest of source file here\` rather than spilling the file.  Maybe the Q8 one will do better when I try it.&lt;/p&gt;\\n\\n&lt;p&gt;If the patch touches several large files, this also makes it liable to overflow the context bringing in and emitting multiple whole files; if the model changes 1 line in a 6.5K token file it has to take in and emit 13K tokens, whereas with a diff it&amp;#39;s much smaller.  For this reason, failures of the model aside, diffs seem to be the natural currency for this.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41ud4l/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752955656,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n41qyyx","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Awwtifishal","can_mod_post":false,"created_utc":1752954563,"send_replies":true,"parent_id":"t3_1m3qg3w","score":1,"author_fullname":"t2_1d96a8k10t","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"After re-reading the thread I realized you want diff/patches. Why? Unless you fine tune a LLM to specialize in delivering changes as diffs, you're better off asking the model for the full files with the changes, or with the agentic tool use of models that support it. LLMs by their nature work better by repeating text with changes. If it's too much for the context, you can replace the messages of the full changed files by only the changed functions and parts, to let the LLM know what it has changed already.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n41qyyx","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;After re-reading the thread I realized you want diff/patches. Why? Unless you fine tune a LLM to specialize in delivering changes as diffs, you&amp;#39;re better off asking the model for the full files with the changes, or with the agentic tool use of models that support it. LLMs by their nature work better by repeating text with changes. If it&amp;#39;s too much for the context, you can replace the messages of the full changed files by only the changed functions and parts, to let the LLM know what it has changed already.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41qyyx/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752954563,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n401woq","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"PatienceKitchen6726","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3ys406","score":1,"author_fullname":"t2_1rxetzin7f","approved_by":null,"mod_note":null,"all_awardings":[],"body":"Being real here I don’t think there are any sensible use cases, the cloud is just too good, and after reading comments here where people mention hugging face using their compute to help train models and such I can’t see a reason. I’m maxed out in my gaming rig at the moment (other than GPU but running rx 7900 xt) and I also am struggling to find reasons to upgrade. My next steps would be a new motherboard so I can put more than 4x32 ram and a better processor in but I’d end up going the server route for ai stuff anyway I think","edited":false,"gildings":{},"downs":0,"author_flair_css_class":null,"name":"t1_n401woq","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Being real here I don’t think there are any sensible use cases, the cloud is just too good, and after reading comments here where people mention hugging face using their compute to help train models and such I can’t see a reason. I’m maxed out in my gaming rig at the moment (other than GPU but running rx 7900 xt) and I also am struggling to find reasons to upgrade. My next steps would be a new motherboard so I can put more than 4x32 ram and a better processor in but I’d end up going the server route for ai stuff anyway I think&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n401woq/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752935405,"author_flair_text":null,"treatment_tags":[],"created_utc":1752935405,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":5,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3ys406","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"lakySK","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3yp5va","score":1,"author_fullname":"t2_y9y2q","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"No worries, I’m looking for an excuse to build an 8040ES system with 1TB RAM as much as the next person here! Just like to play devil’s advocate as I struggle to find a sensible use case. \\n\\nFor you, the fact that this sounds like an async agent, you can probably tolerate the slowness that the system would bring in terms of the prompt processing. \\n\\nNot sure how big your project is, but you could preprocess large contexts and save the KV cache to eliminate the need to wait half an hour for every first token. ","edited":false,"author_flair_css_class":null,"name":"t1_n3ys406","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;No worries, I’m looking for an excuse to build an 8040ES system with 1TB RAM as much as the next person here! Just like to play devil’s advocate as I struggle to find a sensible use case. &lt;/p&gt;\\n\\n&lt;p&gt;For you, the fact that this sounds like an async agent, you can probably tolerate the slowness that the system would bring in terms of the prompt processing. &lt;/p&gt;\\n\\n&lt;p&gt;Not sure how big your project is, but you could preprocess large contexts and save the KV cache to eliminate the need to wait half an hour for every first token. &lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"treatment_tags":[],"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3ys406/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752915589,"author_flair_text":null,"collapsed":false,"created_utc":1752915589,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":4,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3yp5va","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3ynn0m","score":0,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"&gt; So I’m struggling to see a benefit of a local deployment for this use case to be honest.\\n\\nI apologize if it seemed like I was waiting for your opinion on that, and caused you to waste your time giving it.\\n\\nI carefully review PRs, but a \\"co-maintainer\\" if it is successful will end up with closer and more direct access to the project.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3yp5va","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;blockquote&gt;\\n&lt;p&gt;So I’m struggling to see a benefit of a local deployment for this use case to be honest.&lt;/p&gt;\\n&lt;/blockquote&gt;\\n\\n&lt;p&gt;I apologize if it seemed like I was waiting for your opinion on that, and caused you to waste your time giving it.&lt;/p&gt;\\n\\n&lt;p&gt;I carefully review PRs, but a &amp;quot;co-maintainer&amp;quot; if it is successful will end up with closer and more direct access to the project.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3yp5va/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752913917,"author_flair_text":null,"treatment_tags":[],"created_utc":1752913917,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":3,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":0}}],"before":null}},"user_reports":[],"saved":false,"id":"n3ynn0m","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"lakySK","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3ymm3v","score":1,"author_fullname":"t2_y9y2q","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"That’s fair, however, it’s an open source project, if someone wants to mess with it, they can just submit a PR, no?\\n\\nAnd any AI-generated code at this point can definitely not be trusted any more than a random person submitting a PR and needs to be carefully reviewed. \\n\\nSo I’m struggling to see a benefit of a local deployment for this use case to be honest. ","edited":false,"top_awarded_type":null,"downs":0,"author_flair_css_class":null,"name":"t1_n3ynn0m","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;That’s fair, however, it’s an open source project, if someone wants to mess with it, they can just submit a PR, no?&lt;/p&gt;\\n\\n&lt;p&gt;And any AI-generated code at this point can definitely not be trusted any more than a random person submitting a PR and needs to be carefully reviewed. &lt;/p&gt;\\n\\n&lt;p&gt;So I’m struggling to see a benefit of a local deployment for this use case to be honest. &lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3ynn0m/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752913037,"author_flair_text":null,"treatment_tags":[],"created_utc":1752913037,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":2,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n4104ry","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Awwtifishal","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3zja46","score":1,"author_fullname":"t2_1d96a8k10t","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"How? When I use the same samplers and same random seed I get the same result even from thinking models. Are you sure you set the seed to a value that doesn't mean \\"choose one for me\\"? For example the default for llama.cpp is -1 which tells the sampler to pick a random one.","edited":false,"author_flair_css_class":null,"name":"t1_n4104ry","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;How? When I use the same samplers and same random seed I get the same result even from thinking models. Are you sure you set the seed to a value that doesn&amp;#39;t mean &amp;quot;choose one for me&amp;quot;? For example the default for llama.cpp is -1 which tells the sampler to pick a random one.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"treatment_tags":[],"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n4104ry/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752946036,"author_flair_text":null,"collapsed":false,"created_utc":1752946036,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":4,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3zja46","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"johnkapolos","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3z0n06","score":1,"author_fullname":"t2_te4dl","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"Absolutely not possible, especially with thinking models.\\n\\n\\nI tested a similar hypothesis very recently. ","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3zja46","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Absolutely not possible, especially with thinking models.&lt;/p&gt;\\n\\n&lt;p&gt;I tested a similar hypothesis very recently. &lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3zja46/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752928874,"author_flair_text":null,"treatment_tags":[],"created_utc":1752928874,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":3,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"more","data":{"count":0,"name":"t1__","id":"_","parent_id":"t1_n41rlz3","depth":10,"children":[]}}],"before":null}},"user_reports":[],"saved":false,"id":"n41rlz3","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752954770,"send_replies":true,"parent_id":"t1_n41pxtr","score":1,"author_fullname":"t2_z5dk4aa","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"64GB of DDR4, 64 thread CPU, and a 5090 with 32GB DDR7\\n\\nI can run Qwen3-235B-A22B-Q8_0.gguf with 8K context successfully on it, it takes about 1hr to reply to a short query.  But I have not been able to complete a query asking for a patch and providing about 6.5K of tokens as the reference source (I think the context must be larger still).  I have done it on Q4 models similarly, much easier getting the result but the quality is inadequate.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n41rlz3","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;64GB of DDR4, 64 thread CPU, and a 5090 with 32GB DDR7&lt;/p&gt;\\n\\n&lt;p&gt;I can run Qwen3-235B-A22B-Q8_0.gguf with 8K context successfully on it, it takes about 1hr to reply to a short query.  But I have not been able to complete a query asking for a patch and providing about 6.5K of tokens as the reference source (I think the context must be larger still).  I have done it on Q4 models similarly, much easier getting the result but the quality is inadequate.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41rlz3/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752954770,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":9,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n41pxtr","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Awwtifishal","can_mod_post":false,"created_utc":1752954227,"send_replies":true,"parent_id":"t1_n41bb72","score":1,"author_fullname":"t2_1d96a8k10t","approved_by":null,"mod_note":null,"all_awardings":[],"body":"It's not just low, in some cases the perplexity is even lower with Q8 than FP, by pure coincidence. In any case, how much RAM and VRAM do you have?","edited":false,"gildings":{},"downs":0,"author_flair_css_class":null,"name":"t1_n41pxtr","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;It&amp;#39;s not just low, in some cases the perplexity is even lower with Q8 than FP, by pure coincidence. In any case, how much RAM and VRAM do you have?&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41pxtr/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752954227,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":8,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n41bb72","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752949501,"send_replies":true,"parent_id":"t1_n4152xx","score":1,"author_fullname":"t2_z5dk4aa","approved_by":null,"mod_note":null,"all_awardings":[],"body":"The cost to run tests locally on my current box is $0, even the power is from solar.\\n\\nYes I also am coming to think it's best to burn a small amount on renting a box for a day or two (maybe with a restart on a different box) and see what happens.\\n\\nI agree Q8 is meant to be a low amount of difference from the original, but if I can I want to use BF16 so there's no doubt.  But I guess see how it goes.","edited":false,"gildings":{},"author_flair_css_class":null,"name":"t1_n41bb72","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;The cost to run tests locally on my current box is $0, even the power is from solar.&lt;/p&gt;\\n\\n&lt;p&gt;Yes I also am coming to think it&amp;#39;s best to burn a small amount on renting a box for a day or two (maybe with a restart on a different box) and see what happens.&lt;/p&gt;\\n\\n&lt;p&gt;I agree Q8 is meant to be a low amount of difference from the original, but if I can I want to use BF16 so there&amp;#39;s no doubt.  But I guess see how it goes.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n41bb72/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752949501,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":7,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n4152xx","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Awwtifishal","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3z73wh","score":1,"author_fullname":"t2_1d96a8k10t","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"I know, but it's only twice than what you would pay locally if the costs were comparable. If locally costs, say, twice as much, then paying two services ends up costing the same.\\n\\nAnd if you are still in the process of figuring it out, I don't see why not use a cloud service. You can spin up an instance with one or more big GPUs to test the model for a few hours and figure out if precision is the problem, or if it's just that available open LLMs of the sizes you want are not that good at what you want to do (which I think is more likely).\\n\\nAs far as I know, Q8\\\\_0 is essentially indistinguishable from FP16/BF16 for the vast majority of models. Only very small models or MoE models with very small number of active parameters may have a perceptible difference. So except for those cases, you will want to save at least 50% of memory by using Q8\\\\_0 or similar.","edited":false,"gildings":{},"author_flair_css_class":null,"name":"t1_n4152xx","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I know, but it&amp;#39;s only twice than what you would pay locally if the costs were comparable. If locally costs, say, twice as much, then paying two services ends up costing the same.&lt;/p&gt;\\n\\n&lt;p&gt;And if you are still in the process of figuring it out, I don&amp;#39;t see why not use a cloud service. You can spin up an instance with one or more big GPUs to test the model for a few hours and figure out if precision is the problem, or if it&amp;#39;s just that available open LLMs of the sizes you want are not that good at what you want to do (which I think is more likely).&lt;/p&gt;\\n\\n&lt;p&gt;As far as I know, Q8_0 is essentially indistinguishable from FP16/BF16 for the vast majority of models. Only very small models or MoE models with very small number of active parameters may have a perceptible difference. So except for those cases, you will want to save at least 50% of memory by using Q8_0 or similar.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n4152xx/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752947530,"author_flair_text":null,"treatment_tags":[],"created_utc":1752947530,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":6,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3z73wh","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3z5xkj","score":0,"author_fullname":"t2_z5dk4aa","approved_by":null,"mod_note":null,"all_awardings":[],"body":"\\\\&gt; That's assuming\\n\\nNo, \\"twice\\" is referring to having to pay two AI services and compare the results.\\n\\n\\\\&gt; Also, did you test if the models work correctly at full precision, or did you only assume they do?\\n\\n... the whole goal of this post is to find out what, if anything, I need to do to test models at BF16.  If they can't provide usable patches either, I will know to give up and try again in some months / years, because the problems do not in fact start with the quantizations.","edited":false,"gildings":{},"downs":0,"author_flair_css_class":null,"name":"t1_n3z73wh","is_submitter":true,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;&amp;gt; That&amp;#39;s assuming&lt;/p&gt;\\n\\n&lt;p&gt;No, &amp;quot;twice&amp;quot; is referring to having to pay two AI services and compare the results.&lt;/p&gt;\\n\\n&lt;p&gt;&amp;gt; Also, did you test if the models work correctly at full precision, or did you only assume they do?&lt;/p&gt;\\n\\n&lt;p&gt;... the whole goal of this post is to find out what, if anything, I need to do to test models at BF16.  If they can&amp;#39;t provide usable patches either, I will know to give up and try again in some months / years, because the problems do not in fact start with the quantizations.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z73wh/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752923694,"author_flair_text":null,"treatment_tags":[],"created_utc":1752923694,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":5,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":0}}],"before":null}},"user_reports":[],"saved":false,"id":"n3z5xkj","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Awwtifishal","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3z2z8a","score":1,"author_fullname":"t2_1d96a8k10t","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"That's assuming the cost of local inference is comparable to data centers. For big models local inference can be much more expensive at the precisions you want.\\n\\nAlso, did you test if the models work correctly at full precision, or did you only assume they do?","edited":false,"author_flair_css_class":null,"name":"t1_n3z5xkj","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;That&amp;#39;s assuming the cost of local inference is comparable to data centers. For big models local inference can be much more expensive at the precisions you want.&lt;/p&gt;\\n\\n&lt;p&gt;Also, did you test if the models work correctly at full precision, or did you only assume they do?&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"treatment_tags":[],"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z5xkj/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752923129,"author_flair_text":null,"collapsed":false,"created_utc":1752923129,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":4,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3z2z8a","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3z0n06","score":0,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"Sure, it sounds like it should detect malarky.  Or, I can run it locally and not pay double the cost, duplicate all my queries, and deal with syncing and checking both queries.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3z2z8a","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Sure, it sounds like it should detect malarky.  Or, I can run it locally and not pay double the cost, duplicate all my queries, and deal with syncing and checking both queries.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z2z8a/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752921666,"author_flair_text":null,"treatment_tags":[],"created_utc":1752921666,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":3,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":0}}],"before":null}},"user_reports":[],"saved":false,"id":"n3z0n06","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Awwtifishal","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3ymm3v","score":0,"author_fullname":"t2_1d96a8k10t","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"If you can use the same seed and samplers on multiple providers (that uses the same inference software), you can make the request to two of them and it will be highly likely that they match, so when they don't it's an indication that the result has been probably messed up with.","edited":false,"top_awarded_type":null,"downs":0,"author_flair_css_class":null,"name":"t1_n3z0n06","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;If you can use the same seed and samplers on multiple providers (that uses the same inference software), you can make the request to two of them and it will be highly likely that they match, so when they don&amp;#39;t it&amp;#39;s an indication that the result has been probably messed up with.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z0n06/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752920416,"author_flair_text":null,"treatment_tags":[],"created_utc":1752920416,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":2,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":0}}],"before":null}},"user_reports":[],"saved":false,"id":"n3ymm3v","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752912461,"send_replies":true,"parent_id":"t1_n3ym7gi","score":0,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"I do not want external providers to be able to actively and maliciously mess with what is in the patches.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3ymm3v","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I do not want external providers to be able to actively and maliciously mess with what is in the patches.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3ymm3v/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752912461,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":0}}],"before":null}},"user_reports":[],"saved":false,"id":"n3ym7gi","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"lakySK","can_mod_post":false,"created_utc":1752912236,"send_replies":true,"parent_id":"t3_1m3qg3w","score":1,"author_fullname":"t2_y9y2q","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"Just curious, what is your motivation for running this locally?\\n\\nUsually, the main reason is privacy concerns. But with an open source project it doesn’t make too much sense to me. ","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3ym7gi","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Just curious, what is your motivation for running this locally?&lt;/p&gt;\\n\\n&lt;p&gt;Usually, the main reason is privacy concerns. But with an open source project it doesn’t make too much sense to me. &lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3ym7gi/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752912236,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n3ymm1u","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Guilty-History-9249","can_mod_post":false,"created_utc":1752912460,"send_replies":true,"parent_id":"t3_1m3qg3w","score":1,"author_fullname":"t2_rxk6hx4t","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"I literally received my new machine today, technically yesterday.  Just copied over 1 TB's of data from my old 4090 box to it.  Still getting things set up.  \\nI got it to do AI training stuff as I've wasted my first 2.5 years in AI doing inference performance.  Time to dig into training and LLM's although I know all the basics and perhaps an expert on the performance side of inference.  \\nIt has dual 5090's, a 7985WX threadripper, and 256 GB's of DDR5-6000 memory.\\n\\nI too am interested in studying fine tuning or even lora's(little used?) for LLM's.  \\nTime to sleep...  1AM PST here.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3ymm1u","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I literally received my new machine today, technically yesterday.  Just copied over 1 TB&amp;#39;s of data from my old 4090 box to it.  Still getting things set up.&lt;br/&gt;\\nI got it to do AI training stuff as I&amp;#39;ve wasted my first 2.5 years in AI doing inference performance.  Time to dig into training and LLM&amp;#39;s although I know all the basics and perhaps an expert on the performance side of inference.&lt;br/&gt;\\nIt has dual 5090&amp;#39;s, a 7985WX threadripper, and 256 GB&amp;#39;s of DDR5-6000 memory.&lt;/p&gt;\\n\\n&lt;p&gt;I too am interested in studying fine tuning or even lora&amp;#39;s(little used?) for LLM&amp;#39;s.&lt;br/&gt;\\nTime to sleep...  1AM PST here.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3ymm1u/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752912460,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"distinguished":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n3zi2xp","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3zbc4e","score":2,"author_fullname":"t2_z5dk4aa","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"It finished output about 55m after the start, but the answer quality was quite good.  I'll ask it to produce a patch on some code and see what happens (this is what took 9h without output before).","edited":false,"gildings":{},"author_flair_css_class":null,"name":"t1_n3zi2xp","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;It finished output about 55m after the start, but the answer quality was quite good.  I&amp;#39;ll ask it to produce a patch on some code and see what happens (this is what took 9h without output before).&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3zi2xp/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752928401,"author_flair_text":null,"treatment_tags":[],"created_utc":1752928401,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":6,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":2}}],"before":null}},"user_reports":[],"saved":false,"id":"n3zbc4e","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3z68gr","score":1,"author_fullname":"t2_z5dk4aa","approved_by":null,"mod_note":null,"all_awardings":[],"body":"Thanks, this is the first actionable advice... I didn't disable swap before, I did that with \`swapoff -a\` and confirmed it with \`swapon --show\`.  For context, with that model it defaults to 40K, I forced it to 8K.\\n\\nMonitoring with top, I can see 1 x thread is at 99% for kswapd0 even so. llama-server is somewhere between 30xx % (ie, 30 threads maxxed) and 60xx (the actual max 60 threads) at the moment.  Despite that the load average is 60... I guess it means they are all trying to run but slowed down by the NVMe.  iostat shows 2300 tps / 176MB/s\\n\\nIt took ~1m to eat the 49 token prompt and then it's as above for 15m, I'll reply again when something changes.","edited":false,"gildings":{},"downs":0,"author_flair_css_class":null,"name":"t1_n3zbc4e","is_submitter":true,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Thanks, this is the first actionable advice... I didn&amp;#39;t disable swap before, I did that with &lt;code&gt;swapoff -a&lt;/code&gt; and confirmed it with &lt;code&gt;swapon --show&lt;/code&gt;.  For context, with that model it defaults to 40K, I forced it to 8K.&lt;/p&gt;\\n\\n&lt;p&gt;Monitoring with top, I can see 1 x thread is at 99% for kswapd0 even so. llama-server is somewhere between 30xx % (ie, 30 threads maxxed) and 60xx (the actual max 60 threads) at the moment.  Despite that the load average is 60... I guess it means they are all trying to run but slowed down by the NVMe.  iostat shows 2300 tps / 176MB/s&lt;/p&gt;\\n\\n&lt;p&gt;It took ~1m to eat the 49 token prompt and then it&amp;#39;s as above for 15m, I&amp;#39;ll reply again when something changes.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3zbc4e/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752925604,"author_flair_text":null,"treatment_tags":[],"created_utc":1752925604,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":5,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3z68gr","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Aaaaaaaaaeeeee","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3z2i1y","score":2,"author_fullname":"t2_el5pibmej","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Ok thanks, try a short prompt with the GPU backend disabled maybe it's a 5090 problem. Also disabling your swapfile.  you getting stuck at a certain point in Lama server binary or something? Have you lowered context to the minimum?","edited":false,"author_flair_css_class":null,"name":"t1_n3z68gr","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Ok thanks, try a short prompt with the GPU backend disabled maybe it&amp;#39;s a 5090 problem. Also disabling your swapfile.  you getting stuck at a certain point in Lama server binary or something? Have you lowered context to the minimum?&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"link_id":"t3_1m3qg3w","associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"top_awarded_type":null,"unrepliable_reason":null,"author_flair_text_color":null,"treatment_tags":[],"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z68gr/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752923275,"author_flair_text":null,"collapsed":false,"created_utc":1752923275,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":4,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":2}}],"before":null}},"user_reports":[],"saved":false,"id":"n3z2i1y","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3z0t9c","score":0,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"Yes this is all on Linux.  And the model is stored on a 2TB pcie gen 4 NVMe.\\n\\nI iteratively tried to maximize occupancy of my 5090 by looking at the situation on nvidia-smi.  I ended up with --gpu-layers 11 for Qwen3-235B-A22B-Q8_0.gguf.  But as I say: no output on my existing 64GB DDR4 box.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3z2i1y","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Yes this is all on Linux.  And the model is stored on a 2TB pcie gen 4 NVMe.&lt;/p&gt;\\n\\n&lt;p&gt;I iteratively tried to maximize occupancy of my 5090 by looking at the situation on nvidia-smi.  I ended up with --gpu-layers 11 for Qwen3-235B-A22B-Q8_0.gguf.  But as I say: no output on my existing 64GB DDR4 box.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z2i1y/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752921415,"author_flair_text":null,"treatment_tags":[],"created_utc":1752921415,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":3,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":0}}],"before":null}},"user_reports":[],"saved":false,"id":"n3z0t9c","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Aaaaaaaaaeeeee","can_mod_post":false,"send_replies":true,"parent_id":"t1_n3yru6i","score":1,"author_fullname":"t2_el5pibmej","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"For me, I  use ubuntu Linux, downloading the .Safetensors models and see about conversion to gguf, to which I check the pull request to get an idea.\\n\\n\\n\\n\\nOn Windows, I have tried falcon 180B and it took much longer and a lot of writing to disk. There was something wrong here, It might be that I have to disable the pagefile. \\n\\nI haven't actually heard others reports of people doing windows and the disc inference. Maybe you can abandon the idea for now.\\n\\n\\n\\n If you have a Linux box, Do you have a fast enough disk read speed? There are times the hard drive spinning disc is so slow That it has caused the device to overheat, It has happened when I tried to run float16 deepseekv2 from a USB drive. Please try with a solid state drive, I happen to have M2 PCIe Gen 4, with about 8GB/s but it's still possible with the others.\\n\\n\\nMixture experts type models actually only have a certain amount of experts that are grabbed by the model router.\\nThe rest of them are smartly inferenced in your machines vram or ram.\\n\\n\\nHere's a good chart from a good man that shows some of this: \\nhttps://old.reddit.com/r/LocalLLaMA/comments/1lzcuom/kimik2_is_a_deepseek_v3_with_more_experts/","edited":false,"top_awarded_type":null,"downs":0,"author_flair_css_class":null,"name":"t1_n3z0t9c","is_submitter":false,"collapsed":false,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;For me, I  use ubuntu Linux, downloading the .Safetensors models and see about conversion to gguf, to which I check the pull request to get an idea.&lt;/p&gt;\\n\\n&lt;p&gt;On Windows, I have tried falcon 180B and it took much longer and a lot of writing to disk. There was something wrong here, It might be that I have to disable the pagefile. &lt;/p&gt;\\n\\n&lt;p&gt;I haven&amp;#39;t actually heard others reports of people doing windows and the disc inference. Maybe you can abandon the idea for now.&lt;/p&gt;\\n\\n&lt;p&gt; If you have a Linux box, Do you have a fast enough disk read speed? There are times the hard drive spinning disc is so slow That it has caused the device to overheat, It has happened when I tried to run float16 deepseekv2 from a USB drive. Please try with a solid state drive, I happen to have M2 PCIe Gen 4, with about 8GB/s but it&amp;#39;s still possible with the others.&lt;/p&gt;\\n\\n&lt;p&gt;Mixture experts type models actually only have a certain amount of experts that are grabbed by the model router.\\nThe rest of them are smartly inferenced in your machines vram or ram.&lt;/p&gt;\\n\\n&lt;p&gt;Here&amp;#39;s a good chart from a good man that shows some of this: \\n&lt;a href=\\"https://old.reddit.com/r/LocalLLaMA/comments/1lzcuom/kimik2_is_a_deepseek_v3_with_more_experts/\\"&gt;https://old.reddit.com/r/LocalLLaMA/comments/1lzcuom/kimik2_is_a_deepseek_v3_with_more_experts/&lt;/a&gt;&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z0t9c/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752920510,"author_flair_text":null,"treatment_tags":[],"created_utc":1752920510,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":2,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3yru6i","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752915432,"send_replies":true,"parent_id":"t1_n3yq0r7","score":-1,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"I appreciate hearing that this is so in theory, but I downloaded one Q8 model 'Qwen3-235B-A22B-Q8_0.gguf' which totals to 250GB on disk, and left it running on a query for 9 hours before it stopped itself without any output, this is on a 64GB DDR4 box.\\n\\nI realize that is not an ideal platform to try it on, but clearly there is more to it than, \\"All models even 2tb can be tested in bf16, regardless how little resources you may have.\\".\\n\\nI am really asking what do I have to do on the hardware side, to be able to use a large Q8 (or much better, BF16) model.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3yru6i","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;I appreciate hearing that this is so in theory, but I downloaded one Q8 model &amp;#39;Qwen3-235B-A22B-Q8_0.gguf&amp;#39; which totals to 250GB on disk, and left it running on a query for 9 hours before it stopped itself without any output, this is on a 64GB DDR4 box.&lt;/p&gt;\\n\\n&lt;p&gt;I realize that is not an ideal platform to try it on, but clearly there is more to it than, &amp;quot;All models even 2tb can be tested in bf16, regardless how little resources you may have.&amp;quot;.&lt;/p&gt;\\n\\n&lt;p&gt;I am really asking what do I have to do on the hardware side, to be able to use a large Q8 (or much better, BF16) model.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3yru6i/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752915432,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":-1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3yq0r7","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Aaaaaaaaaeeeee","can_mod_post":false,"created_utc":1752914407,"send_replies":true,"parent_id":"t3_1m3qg3w","score":0,"author_fullname":"t2_el5pibmej","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"That is possible, for smaller models you can run the full transformers model with the fast gpu exllamav2 backend in text-gen-webui. Also, you can convert to gguf in order to get llama.cpp's backend which has offloading properties to your  RAM+vram and then from ssd disc storage. All models even 2tb can be tested in bf16, regardless how little resources you may have.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3yq0r7","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;That is possible, for smaller models you can run the full transformers model with the fast gpu exllamav2 backend in text-gen-webui. Also, you can convert to gguf in order to get llama.cpp&amp;#39;s backend which has offloading properties to your  RAM+vram and then from ssd disc storage. All models even 2tb can be tested in bf16, regardless how little resources you may have.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3yq0r7/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752914407,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":0}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n3z3lwf","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"bitrumpled","can_mod_post":false,"created_utc":1752921989,"send_replies":true,"parent_id":"t1_n3z02jk","score":1,"author_fullname":"t2_z5dk4aa","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Thanks.  But, this still requires me to be able to run the BF16 model to get outputs to use in the training, so as an answer to \\"how can I run a BF16 model\\" this isn't super useful.  And I need to rent a big rig to do the training IIUI.\\n\\nThe outer reason for trying to run BF16 at all is to answer the question, \\"are the models usable for maintaining at all\\"?  Because the casually quantized ones are not, to the extent they cannot produce a diff I can give to \`patch\` successfully, before even considering the quality of the changes in the patch.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3z3lwf","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Thanks.  But, this still requires me to be able to run the BF16 model to get outputs to use in the training, so as an answer to &amp;quot;how can I run a BF16 model&amp;quot; this isn&amp;#39;t super useful.  And I need to rent a big rig to do the training IIUI.&lt;/p&gt;\\n\\n&lt;p&gt;The outer reason for trying to run BF16 at all is to answer the question, &amp;quot;are the models usable for maintaining at all&amp;quot;?  Because the casually quantized ones are not, to the extent they cannot produce a diff I can give to &lt;code&gt;patch&lt;/code&gt; successfully, before even considering the quality of the changes in the patch.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m3qg3w","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z3lwf/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752921989,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n3z02jk","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"Longjumpingfish0403","can_mod_post":false,"created_utc":1752920103,"send_replies":true,"parent_id":"t3_1m3qg3w","score":0,"author_fullname":"t2_jarttha4","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"It's worth exploring the approach of model distillation for your needs. By training a smaller model to mimic the large BF16 model's outputs, you could potentially reduce hardware demands without sacrificing much in terms of output quality. Also, check if any hybrid quantization techniques might offer a balance between performance and hardware constraints.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n3z02jk","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;It&amp;#39;s worth exploring the approach of model distillation for your needs. By training a smaller model to mimic the large BF16 model&amp;#39;s outputs, you could potentially reduce hardware demands without sacrificing much in terms of output quality. Also, check if any hybrid quantization techniques might offer a balance between performance and hardware constraints.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m3qg3w/escaping_quantization_brain_damage_with_bf16/n3z02jk/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1752920103,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m3qg3w","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":0}}],"before":null}}]`),r=()=>e.jsx(t,{data:a});export{r as default};
