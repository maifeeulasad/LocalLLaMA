import{j as e}from"./index-Cd3v0jxz.js";import{R as t}from"./RedditPostRenderer-cI96YLhy.js";import"./index-DGBoKyQm.js";const l=JSON.parse(`[{"kind":"Listing","data":{"after":null,"dist":1,"modhash":"","geo_filter":"","children":[{"kind":"t3","data":{"approved_at_utc":null,"subreddit":"LocalLLaMA","selftext":"Hey guys, I have a Lenovo P700 with both CPUs installed which means it can have 768GB of ram, currently 64GB installed. I also have 4 A4000 cards in it. I downloaded QWEN3-Coder with LM Studio and it says the model is too big. If I upgrade the CPU Ram, will that allow it to share the model across GPU and CPU?    \\nDo I need to run it in Ollama for that to work?    \\nI understand it will be slow (if that works), but im fine with that.","user_reports":[],"saved":false,"mod_reason_title":null,"gilded":0,"clicked":false,"title":"CPU &amp; GPU Ram usage?","link_flair_richtext":[{"e":"text","t":"Question | Help"}],"subreddit_name_prefixed":"r/LocalLLaMA","hidden":false,"pwls":6,"link_flair_css_class":"","downs":0,"thumbnail_height":null,"top_awarded_type":null,"hide_score":false,"name":"t3_1m89upm","quarantine":false,"link_flair_text_color":"dark","upvote_ratio":1,"author_flair_background_color":null,"subreddit_type":"public","ups":2,"total_awards_received":0,"media_embed":{},"thumbnail_width":null,"author_flair_template_id":null,"is_original_content":false,"author_fullname":"t2_46jd1","secure_media":null,"is_reddit_media_domain":false,"is_meta":false,"category":null,"secure_media_embed":{},"link_flair_text":"Question | Help","can_mod_post":false,"score":2,"approved_by":null,"is_created_from_ads_ui":false,"author_premium":false,"thumbnail":"self","edited":false,"author_flair_css_class":null,"author_flair_richtext":[],"gildings":{},"content_categories":null,"is_self":true,"mod_note":null,"created":1753376316,"link_flair_type":"richtext","wls":6,"removed_by_category":null,"banned_by":null,"author_flair_type":"text","domain":"self.LocalLLaMA","allow_live_comments":false,"selftext_html":"&lt;!-- SC_OFF --&gt;&lt;div class=\\"md\\"&gt;&lt;p&gt;Hey guys, I have a Lenovo P700 with both CPUs installed which means it can have 768GB of ram, currently 64GB installed. I also have 4 A4000 cards in it. I downloaded QWEN3-Coder with LM Studio and it says the model is too big. If I upgrade the CPU Ram, will that allow it to share the model across GPU and CPU?&lt;br/&gt;\\nDo I need to run it in Ollama for that to work?&lt;br/&gt;\\nI understand it will be slow (if that works), but im fine with that.&lt;/p&gt;\\n&lt;/div&gt;&lt;!-- SC_ON --&gt;","likes":null,"suggested_sort":null,"banned_at_utc":null,"view_count":null,"archived":false,"no_follow":false,"is_crosspostable":false,"pinned":false,"over_18":false,"all_awardings":[],"awarders":[],"media_only":false,"link_flair_template_id":"2c9831e6-bf92-11ed-98e6-d2b8bcc02ae1","can_gild":false,"spoiler":false,"locked":false,"author_flair_text":null,"treatment_tags":[],"visited":false,"removed_by":null,"num_reports":null,"distinguished":null,"subreddit_id":"t5_81eyvm","author_is_blocked":false,"mod_reason_by":null,"removal_reason":null,"link_flair_background_color":"#5a74cc","id":"1m89upm","is_robot_indexable":true,"num_duplicates":0,"report_reasons":null,"author":"ShreddinPB","discussion_type":null,"num_comments":5,"send_replies":true,"media":null,"contest_mode":false,"author_patreon_flair":false,"author_flair_text_color":null,"permalink":"/r/LocalLLaMA/comments/1m89upm/cpu_gpu_ram_usage/","stickied":false,"url":"https://www.reddit.com/r/LocalLLaMA/comments/1m89upm/cpu_gpu_ram_usage/","subreddit_subscribers":504023,"created_utc":1753376316,"num_crossposts":0,"mod_reports":[],"is_video":false}}],"before":null}},{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"richtext","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":"ed89e5c6-72f1-11ee-9954-1697022cd89d","likes":null,"replies":"","user_reports":[],"saved":false,"id":"n4xvj0j","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"ttkciar","can_mod_post":false,"send_replies":true,"parent_id":"t1_n4xoq5q","score":2,"author_fullname":"t2_cpegz","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Yeah, what tmvr said.  The rule of thumb is that memory requirements are equal to model file size plus some overhead for inference state, which can be anywhere from a little under a gigabyte to several dozen gigabytes, depending mostly on context limit.\\n\\nI lower the Gemma3-27B (Q4_K_M) context limit to 4K to make it fit in my 32GB MI60; at 128K context limit it needs 98GB.  Similarly, my Xeon server \\"only\\" has 256GB of main memory, so to make Tulu3-405B (Q4_K_M) fit in memory I have to lower its context limit to 8K.  This is all for llama.cpp, and different inference stacks have different memory overhead (in)efficiencies, so YMMV.","edited":false,"top_awarded_type":null,"downs":0,"author_flair_css_class":null,"name":"t1_n4xvj0j","is_submitter":false,"collapsed":false,"author_flair_richtext":[{"e":"text","t":"llama.cpp"}],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Yeah, what tmvr said.  The rule of thumb is that memory requirements are equal to model file size plus some overhead for inference state, which can be anywhere from a little under a gigabyte to several dozen gigabytes, depending mostly on context limit.&lt;/p&gt;\\n\\n&lt;p&gt;I lower the Gemma3-27B (Q4_K_M) context limit to 4K to make it fit in my 32GB MI60; at 128K context limit it needs 98GB.  Similarly, my Xeon server &amp;quot;only&amp;quot; has 256GB of main memory, so to make Tulu3-405B (Q4_K_M) fit in memory I have to lower its context limit to 8K.  This is all for llama.cpp, and different inference stacks have different memory overhead (in)efficiencies, so YMMV.&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m89upm","unrepliable_reason":null,"author_flair_text_color":"light","score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m89upm/cpu_gpu_ram_usage/n4xvj0j/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1753379580,"author_flair_text":"llama.cpp","treatment_tags":[],"created_utc":1753379580,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":2,"author_flair_background_color":"#bbbdbf","collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":2}}],"before":null}},"user_reports":[],"saved":false,"id":"n4xoq5q","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"ShreddinPB","can_mod_post":false,"created_utc":1753377772,"send_replies":true,"parent_id":"t1_n4xnm2j","score":1,"author_fullname":"t2_46jd1","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Thank you","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n4xoq5q","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Thank you&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m89upm","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m89upm/cpu_gpu_ram_usage/n4xoq5q/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1753377772,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n4xnm2j","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"tmvr","can_mod_post":false,"created_utc":1753377477,"send_replies":true,"parent_id":"t3_1m89upm","score":2,"author_fullname":"t2_11qlhv","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"Right now you have 128GB memory in total, so of course it does not fit, the smallest Q2\\\\_K is 175GB:\\n\\n[https://huggingface.co/unsloth/Qwen3-Coder-480B-A35B-Instruct-GGUF](https://huggingface.co/unsloth/Qwen3-Coder-480B-A35B-Instruct-GGUF)\\n\\n(unsloth says don't use Q1, it's broken).\\n\\nSo you need to add RAM accordingly. You don't need Ollama to run it, you can keep LM Studio, the issue you have is not software related.","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n4xnm2j","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Right now you have 128GB memory in total, so of course it does not fit, the smallest Q2_K is 175GB:&lt;/p&gt;\\n\\n&lt;p&gt;&lt;a href=\\"https://huggingface.co/unsloth/Qwen3-Coder-480B-A35B-Instruct-GGUF\\"&gt;https://huggingface.co/unsloth/Qwen3-Coder-480B-A35B-Instruct-GGUF&lt;/a&gt;&lt;/p&gt;\\n\\n&lt;p&gt;(unsloth says don&amp;#39;t use Q1, it&amp;#39;s broken).&lt;/p&gt;\\n\\n&lt;p&gt;So you need to add RAM accordingly. You don&amp;#39;t need Ollama to run it, you can keep LM Studio, the issue you have is not software related.&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m89upm/cpu_gpu_ram_usage/n4xnm2j/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1753377477,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m89upm","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":2}},{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n4ywkul","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"ShreddinPB","can_mod_post":false,"created_utc":1753390020,"send_replies":true,"parent_id":"t1_n4ycm72","score":1,"author_fullname":"t2_46jd1","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Great response, thank you.  \\nRight now 64gb ram is about $95, was considering getting 3 more sets.  \\nFor the large context code operations I really dont care about the speed of it honestly :)    \\nedit: got the ram size wrong","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n4ywkul","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Great response, thank you.&lt;br/&gt;\\nRight now 64gb ram is about $95, was considering getting 3 more sets.&lt;br/&gt;\\nFor the large context code operations I really dont care about the speed of it honestly :)&lt;br/&gt;\\nedit: got the ram size wrong&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1m89upm","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m89upm/cpu_gpu_ram_usage/n4ywkul/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1753390020,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n4ycm72","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"powasky","can_mod_post":false,"created_utc":1753384422,"send_replies":true,"parent_id":"t3_1m89upm","score":2,"author_fullname":"t2_erzgo","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":" P700 with 768GB potential is hardcore! Love seeing someone push the boundaries of what's possible.\\n\\nAnyway...yes, upgrading your system RAM will absolutely help with running larger models that don't fit in VRAM. Both LM Studio and Ollama can offload layers to system RAM when you run out of GPU memory. Your 4x A4000s give you about 64GB of VRAM total, so anything bigger will need that CPU RAM as backup.\\n\\nLM Studio should handle the CPU/GPU hybrid inference automatically - you don't necessarily need to switch to Ollama, though Ollama does tend to be a bit more aggressive about using available system memory efficiently. Both will work, just depends on your preference.\\n\\nThe real bottleneck is gonna be that PCIe bandwidth when shuttling data between system RAM and your GPUs. It'll work but yeah, it's gonna be painfully slow compared to pure VRAM inference. Think minutes per response instead of seconds.\\n\\nFor a model that big you might want to consider just spinning up a cloud instance on Runpod when you need it - probably faster and definitely cheaper than maxing out 768GB of DDR4. But I get the appeal of having everything local, especially with that beast of a workstation!","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n4ycm72","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;P700 with 768GB potential is hardcore! Love seeing someone push the boundaries of what&amp;#39;s possible.&lt;/p&gt;\\n\\n&lt;p&gt;Anyway...yes, upgrading your system RAM will absolutely help with running larger models that don&amp;#39;t fit in VRAM. Both LM Studio and Ollama can offload layers to system RAM when you run out of GPU memory. Your 4x A4000s give you about 64GB of VRAM total, so anything bigger will need that CPU RAM as backup.&lt;/p&gt;\\n\\n&lt;p&gt;LM Studio should handle the CPU/GPU hybrid inference automatically - you don&amp;#39;t necessarily need to switch to Ollama, though Ollama does tend to be a bit more aggressive about using available system memory efficiently. Both will work, just depends on your preference.&lt;/p&gt;\\n\\n&lt;p&gt;The real bottleneck is gonna be that PCIe bandwidth when shuttling data between system RAM and your GPUs. It&amp;#39;ll work but yeah, it&amp;#39;s gonna be painfully slow compared to pure VRAM inference. Think minutes per response instead of seconds.&lt;/p&gt;\\n\\n&lt;p&gt;For a model that big you might want to consider just spinning up a cloud instance on Runpod when you need it - probably faster and definitely cheaper than maxing out 768GB of DDR4. But I get the appeal of having everything local, especially with that beast of a workstation!&lt;/p&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1m89upm/cpu_gpu_ram_usage/n4ycm72/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1753384422,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1m89upm","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":2}}],"before":null}}]`),r=()=>e.jsx(t,{data:l});export{r as default};
