import{j as e}from"./index-CjwP30j7.js";import{R as t}from"./RedditPostRenderer-BbYuEq_V.js";import"./index-C-yxLSPN.js";const a=JSON.parse(`[{"kind":"Listing","data":{"after":null,"dist":1,"modhash":"","geo_filter":"","children":[{"kind":"t3","data":{"approved_at_utc":null,"subreddit":"LocalLLaMA","selftext":"I have a desktop on my LAN that I'm using for inference. I start ./llama-server on that desktop, and then submit queries using curl. However, when I submit queries using the \\"prompt\\" field, I get replies back that look like foundation model completions, rather than instruct completions. I assume this is because something is going wrong with the template, so my question is really about how to properly set up the template with llama-server. I know this is a basic question but I haven't been able to find a working recipe... any help/insights/guidance/links appreciated...\\n\\nHere are my commands:\\n\\n    # On the host:\\n    % ./llama-server --jinja -t 30 -m $MODELS/Qwen3-8B-Q4_K_M.gguf --host $HOST_IP --port 11434 --prio 3 --n-gpu-layers 20 --no-webui\\n\\n    # On the client:\\n    % curl --request POST --url http://$HOST_IP:11434/completion --header \\"Content-Type: application/json\\" --data '{\\"prompt\\": \\"What is the capital of Italy?\\", \\"n_predict\\": 100}'  | jq -r '.content'\\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\\n                                     Dload  Upload   Total   Spent    Left  Speed\\n    100  2082  100  2021  100    61    226      6  0:00:10  0:00:08  0:00:02   429\\n     How many states are there in the United States? What is the largest planet in our solar system? What is the chemical symbol for water? What is the square root of 64? What is the main function of the liver in the human body? What is the most common language spoken in Brazil? What is the smallest prime number? What is the formula for calculating the area of a circle? What is the capital of France? What is the process by which plants make their own food using sunlight","user_reports":[],"saved":false,"mod_reason_title":null,"gilded":0,"clicked":false,"title":"Llama server completion not working correctly","link_flair_richtext":[{"e":"text","t":"Question | Help"}],"subreddit_name_prefixed":"r/LocalLLaMA","hidden":false,"pwls":6,"link_flair_css_class":"","downs":0,"thumbnail_height":null,"top_awarded_type":null,"hide_score":false,"name":"t3_1lshxep","quarantine":false,"link_flair_text_color":"dark","upvote_ratio":0.5,"author_flair_background_color":null,"subreddit_type":"public","ups":0,"total_awards_received":0,"media_embed":{},"thumbnail_width":null,"author_flair_template_id":null,"is_original_content":false,"author_fullname":"t2_61b8b","secure_media":null,"is_reddit_media_domain":false,"is_meta":false,"category":null,"secure_media_embed":{},"link_flair_text":"Question | Help","can_mod_post":false,"score":0,"approved_by":null,"is_created_from_ads_ui":false,"author_premium":false,"thumbnail":"self","edited":false,"author_flair_css_class":null,"author_flair_richtext":[],"gildings":{},"content_categories":null,"is_self":true,"mod_note":null,"created":1751743641,"link_flair_type":"richtext","wls":6,"removed_by_category":null,"banned_by":null,"author_flair_type":"text","domain":"self.LocalLLaMA","allow_live_comments":false,"selftext_html":"&lt;!-- SC_OFF --&gt;&lt;div class=\\"md\\"&gt;&lt;p&gt;I have a desktop on my LAN that I&amp;#39;m using for inference. I start ./llama-server on that desktop, and then submit queries using curl. However, when I submit queries using the &amp;quot;prompt&amp;quot; field, I get replies back that look like foundation model completions, rather than instruct completions. I assume this is because something is going wrong with the template, so my question is really about how to properly set up the template with llama-server. I know this is a basic question but I haven&amp;#39;t been able to find a working recipe... any help/insights/guidance/links appreciated...&lt;/p&gt;\\n\\n&lt;p&gt;Here are my commands:&lt;/p&gt;\\n\\n&lt;pre&gt;&lt;code&gt;# On the host:\\n% ./llama-server --jinja -t 30 -m $MODELS/Qwen3-8B-Q4_K_M.gguf --host $HOST_IP --port 11434 --prio 3 --n-gpu-layers 20 --no-webui\\n\\n# On the client:\\n% curl --request POST --url http://$HOST_IP:11434/completion --header &amp;quot;Content-Type: application/json&amp;quot; --data &amp;#39;{&amp;quot;prompt&amp;quot;: &amp;quot;What is the capital of Italy?&amp;quot;, &amp;quot;n_predict&amp;quot;: 100}&amp;#39;  | jq -r &amp;#39;.content&amp;#39;\\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\\n                                 Dload  Upload   Total   Spent    Left  Speed\\n100  2082  100  2021  100    61    226      6  0:00:10  0:00:08  0:00:02   429\\n How many states are there in the United States? What is the largest planet in our solar system? What is the chemical symbol for water? What is the square root of 64? What is the main function of the liver in the human body? What is the most common language spoken in Brazil? What is the smallest prime number? What is the formula for calculating the area of a circle? What is the capital of France? What is the process by which plants make their own food using sunlight\\n&lt;/code&gt;&lt;/pre&gt;\\n&lt;/div&gt;&lt;!-- SC_ON --&gt;","likes":null,"suggested_sort":null,"banned_at_utc":null,"view_count":null,"archived":false,"no_follow":true,"is_crosspostable":false,"pinned":false,"over_18":false,"all_awardings":[],"awarders":[],"media_only":false,"link_flair_template_id":"2c9831e6-bf92-11ed-98e6-d2b8bcc02ae1","can_gild":false,"spoiler":false,"locked":false,"author_flair_text":null,"treatment_tags":[],"visited":false,"removed_by":null,"num_reports":null,"distinguished":null,"subreddit_id":"t5_81eyvm","author_is_blocked":false,"mod_reason_by":null,"removal_reason":null,"link_flair_background_color":"#5a74cc","id":"1lshxep","is_robot_indexable":true,"num_duplicates":0,"report_reasons":null,"author":"claytonkb","discussion_type":null,"num_comments":2,"send_replies":true,"media":null,"contest_mode":false,"author_patreon_flair":false,"author_flair_text_color":null,"permalink":"/r/LocalLLaMA/comments/1lshxep/llama_server_completion_not_working_correctly/","stickied":false,"url":"https://www.reddit.com/r/LocalLLaMA/comments/1lshxep/llama_server_completion_not_working_correctly/","subreddit_subscribers":494986,"created_utc":1751743641,"num_crossposts":0,"mod_reports":[],"is_video":false}}],"before":null}},{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":{"kind":"Listing","data":{"after":null,"dist":null,"modhash":"","geo_filter":"","children":[{"kind":"t1","data":{"subreddit_id":"t5_81eyvm","approved_at_utc":null,"author_is_blocked":false,"comment_type":null,"awarders":[],"mod_reason_by":null,"banned_by":null,"author_flair_type":"text","total_awards_received":0,"subreddit":"LocalLLaMA","author_flair_template_id":null,"likes":null,"replies":"","user_reports":[],"saved":false,"id":"n1jt3ib","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"claytonkb","can_mod_post":false,"created_utc":1751757789,"send_replies":true,"parent_id":"t1_n1jgo2m","score":1,"author_fullname":"t2_61b8b","removal_reason":null,"approved_by":null,"mod_note":null,"all_awardings":[],"body":"Thank you, that worked!!","edited":false,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n1jt3ib","is_submitter":true,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;Thank you, that worked!!&lt;/p&gt;\\n&lt;/div&gt;","gildings":{},"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"link_id":"t3_1lshxep","unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1lshxep/llama_server_completion_not_working_correctly/n1jt3ib/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1751757789,"author_flair_text":null,"treatment_tags":[],"collapsed":false,"subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":1,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":1}}],"before":null}},"user_reports":[],"saved":false,"id":"n1jgo2m","banned_at_utc":null,"mod_reason_title":null,"gilded":0,"archived":false,"collapsed_reason_code":null,"no_follow":true,"author":"muxxington","can_mod_post":false,"created_utc":1751753276,"send_replies":true,"parent_id":"t3_1lshxep","score":3,"author_fullname":"t2_1ktdmsvo","approved_by":null,"mod_note":null,"all_awardings":[],"collapsed":false,"body":"You want this:\\n\\n    curl -s http://$HOST_IP:11434/v1/chat/completions \\\\\\n      -H \\"Content-Type: application/json\\" \\\\\\n      -d '{\\n        \\"messages\\": [\\n          { \\"role\\": \\"user\\", \\"content\\": \\"What is the capital of Italy?\\" }\\n        ],\\n        \\"max_tokens\\": 100 \\n    }' | jq -r '.choices[].message.content'","edited":1751753495,"top_awarded_type":null,"author_flair_css_class":null,"name":"t1_n1jgo2m","is_submitter":false,"downs":0,"author_flair_richtext":[],"author_patreon_flair":false,"body_html":"&lt;div class=\\"md\\"&gt;&lt;p&gt;You want this:&lt;/p&gt;\\n\\n&lt;pre&gt;&lt;code&gt;curl -s http://$HOST_IP:11434/v1/chat/completions \\\\\\n  -H &amp;quot;Content-Type: application/json&amp;quot; \\\\\\n  -d &amp;#39;{\\n    &amp;quot;messages&amp;quot;: [\\n      { &amp;quot;role&amp;quot;: &amp;quot;user&amp;quot;, &amp;quot;content&amp;quot;: &amp;quot;What is the capital of Italy?&amp;quot; }\\n    ],\\n    &amp;quot;max_tokens&amp;quot;: 100 \\n}&amp;#39; | jq -r &amp;#39;.choices[].message.content&amp;#39;\\n&lt;/code&gt;&lt;/pre&gt;\\n&lt;/div&gt;","removal_reason":null,"collapsed_reason":null,"distinguished":null,"associated_award":null,"stickied":false,"author_premium":false,"can_gild":false,"gildings":{},"unrepliable_reason":null,"author_flair_text_color":null,"score_hidden":false,"permalink":"/r/LocalLLaMA/comments/1lshxep/llama_server_completion_not_working_correctly/n1jgo2m/","subreddit_type":"public","locked":false,"report_reasons":null,"created":1751753276,"author_flair_text":null,"treatment_tags":[],"link_id":"t3_1lshxep","subreddit_name_prefixed":"r/LocalLLaMA","controversiality":0,"depth":0,"author_flair_background_color":null,"collapsed_because_crowd_control":null,"mod_reports":[],"num_reports":null,"ups":3}}],"before":null}}]`),r=()=>e.jsx(t,{data:a});export{r as default};
