[
  {
    "kind": "Listing",
    "data": {
      "after": null,
      "dist": 1,
      "modhash": "",
      "geo_filter": "",
      "children": [
        {
          "kind": "t3",
          "data": {
            "approved_at_utc": null,
            "subreddit": "LocalLLaMA",
            "selftext": "Here is a crazy idea and I am wondering if it might work. My LLM thinks it will :-)\n\nThe idea is to have a shared server with GPU and up to 8 expert servers. Those would be physical servers each with a dedicated 100 Gbps link to the shared server. The shared server could be with Nvidia 5090 and the expert servers could be AMD Epyc for CPU inference. All servers have a complete copy of the model and can run any random experts for each token.\n\nWe would have the shared server run each forward pass up to the point where the 8 experts get selected. We will there pass the activations to the expert servers, each server running the inference for just one expert. After running through all the layers, the activations get transferred back. That way there are only 2 transfers per token. We are not going to transfer activations by layers, which would otherwise be required.\n\nBy running the experts in parallel like that, we will drastically speed up the generation time.\n\nI am aware we currently do not have software that could do the above. But what are your thoughts on the idea? I am thinking DeepSeek R1, Qwen3 Coder 480b, Kimi K2 etc with tokens speed multiple what is possible today on CPU inference.",
            "user_reports": [],
            "saved": false,
            "mod_reason_title": null,
            "gilded": 0,
            "clicked": false,
            "title": "Cluster idea for MoE",
            "link_flair_richtext": [
              {
                "e": "text",
                "t": "Discussion"
              }
            ],
            "subreddit_name_prefixed": "r/LocalLLaMA",
            "hidden": false,
            "pwls": 6,
            "link_flair_css_class": "",
            "downs": 0,
            "thumbnail_height": null,
            "top_awarded_type": null,
            "hide_score": false,
            "name": "t3_1m9q92z",
            "quarantine": false,
            "link_flair_text_color": "light",
            "upvote_ratio": 0.5,
            "author_flair_background_color": null,
            "subreddit_type": "public",
            "ups": 0,
            "total_awards_received": 0,
            "media_embed": {},
            "thumbnail_width": null,
            "author_flair_template_id": null,
            "is_original_content": false,
            "author_fullname": "t2_bvqb8ng0",
            "secure_media": null,
            "is_reddit_media_domain": false,
            "is_meta": false,
            "category": null,
            "secure_media_embed": {},
            "link_flair_text": "Discussion",
            "can_mod_post": false,
            "score": 0,
            "approved_by": null,
            "is_created_from_ads_ui": false,
            "author_premium": false,
            "thumbnail": "self",
            "edited": false,
            "author_flair_css_class": null,
            "author_flair_richtext": [],
            "gildings": {},
            "content_categories": null,
            "is_self": true,
            "mod_note": null,
            "created": 1753526640,
            "link_flair_type": "richtext",
            "wls": 6,
            "removed_by_category": null,
            "banned_by": null,
            "author_flair_type": "text",
            "domain": "self.LocalLLaMA",
            "allow_live_comments": false,
            "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;Here is a crazy idea and I am wondering if it might work. My LLM thinks it will :-)&lt;/p&gt;\n\n&lt;p&gt;The idea is to have a shared server with GPU and up to 8 expert servers. Those would be physical servers each with a dedicated 100 Gbps link to the shared server. The shared server could be with Nvidia 5090 and the expert servers could be AMD Epyc for CPU inference. All servers have a complete copy of the model and can run any random experts for each token.&lt;/p&gt;\n\n&lt;p&gt;We would have the shared server run each forward pass up to the point where the 8 experts get selected. We will there pass the activations to the expert servers, each server running the inference for just one expert. After running through all the layers, the activations get transferred back. That way there are only 2 transfers per token. We are not going to transfer activations by layers, which would otherwise be required.&lt;/p&gt;\n\n&lt;p&gt;By running the experts in parallel like that, we will drastically speed up the generation time.&lt;/p&gt;\n\n&lt;p&gt;I am aware we currently do not have software that could do the above. But what are your thoughts on the idea? I am thinking DeepSeek R1, Qwen3 Coder 480b, Kimi K2 etc with tokens speed multiple what is possible today on CPU inference.&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;",
            "likes": null,
            "suggested_sort": null,
            "banned_at_utc": null,
            "view_count": null,
            "archived": false,
            "no_follow": true,
            "is_crosspostable": false,
            "pinned": false,
            "over_18": false,
            "all_awardings": [],
            "awarders": [],
            "media_only": false,
            "link_flair_template_id": "5f921ea4-c7bc-11ed-9c23-3a00622979b4",
            "can_gild": false,
            "spoiler": false,
            "locked": false,
            "author_flair_text": null,
            "treatment_tags": [],
            "visited": false,
            "removed_by": null,
            "num_reports": null,
            "distinguished": null,
            "subreddit_id": "t5_81eyvm",
            "author_is_blocked": false,
            "mod_reason_by": null,
            "removal_reason": null,
            "link_flair_background_color": "#646d73",
            "id": "1m9q92z",
            "is_robot_indexable": true,
            "num_duplicates": 0,
            "report_reasons": null,
            "author": "Baldur-Norddahl",
            "discussion_type": null,
            "num_comments": 9,
            "send_replies": true,
            "media": null,
            "contest_mode": false,
            "author_patreon_flair": false,
            "author_flair_text_color": null,
            "permalink": "/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/",
            "stickied": false,
            "url": "https://www.reddit.com/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/",
            "subreddit_subscribers": 504973,
            "created_utc": 1753526640,
            "num_crossposts": 0,
            "mod_reports": [],
            "is_video": false
          }
        }
      ],
      "before": null
    }
  },
  {
    "kind": "Listing",
    "data": {
      "after": null,
      "dist": null,
      "modhash": "",
      "geo_filter": "",
      "children": [
        {
          "kind": "t1",
          "data": {
            "subreddit_id": "t5_81eyvm",
            "approved_at_utc": null,
            "author_is_blocked": false,
            "comment_type": null,
            "awarders": [],
            "mod_reason_by": null,
            "banned_by": null,
            "author_flair_type": "text",
            "total_awards_received": 0,
            "subreddit": "LocalLLaMA",
            "author_flair_template_id": null,
            "likes": null,
            "replies": {
              "kind": "Listing",
              "data": {
                "after": null,
                "dist": null,
                "modhash": "",
                "geo_filter": "",
                "children": [
                  {
                    "kind": "t1",
                    "data": {
                      "subreddit_id": "t5_81eyvm",
                      "approved_at_utc": null,
                      "author_is_blocked": false,
                      "comment_type": null,
                      "awarders": [],
                      "mod_reason_by": null,
                      "banned_by": null,
                      "author_flair_type": "text",
                      "total_awards_received": 0,
                      "subreddit": "LocalLLaMA",
                      "author_flair_template_id": null,
                      "likes": null,
                      "replies": "",
                      "user_reports": [],
                      "saved": false,
                      "id": "n5905xr",
                      "banned_at_utc": null,
                      "mod_reason_title": null,
                      "gilded": 0,
                      "archived": false,
                      "collapsed_reason_code": null,
                      "no_follow": true,
                      "author": "Baldur-Norddahl",
                      "can_mod_post": false,
                      "created_utc": 1753530134,
                      "send_replies": true,
                      "parent_id": "t1_n58vjg4",
                      "score": 1,
                      "author_fullname": "t2_bvqb8ng0",
                      "removal_reason": null,
                      "approved_by": null,
                      "mod_note": null,
                      "all_awardings": [],
                      "body": "It is not as simple as that. Within a budget, you could for example get two Apple Studio M3 Ultra 256 GB or one 512 GB. With option of getting two of the 256 GB models, you could potentially network them and get twice the inference speed of Qwen3 480b at q4. With the 512 GB you would gain the option to run DeepSeek R1 (at q4) but now be limited to lower tps on the Qwen3 due to only having one machine.\n\nThe latency hit would not be big. It only takes 2-5 milliseconds to do the transfer using the Thunderbolt port on the Macs. With the already low tokens per second, this delay is not going to dominate the final tps.",
                      "edited": false,
                      "top_awarded_type": null,
                      "author_flair_css_class": null,
                      "name": "t1_n5905xr",
                      "is_submitter": true,
                      "downs": 0,
                      "author_flair_richtext": [],
                      "author_patreon_flair": false,
                      "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;It is not as simple as that. Within a budget, you could for example get two Apple Studio M3 Ultra 256 GB or one 512 GB. With option of getting two of the 256 GB models, you could potentially network them and get twice the inference speed of Qwen3 480b at q4. With the 512 GB you would gain the option to run DeepSeek R1 (at q4) but now be limited to lower tps on the Qwen3 due to only having one machine.&lt;/p&gt;\n\n&lt;p&gt;The latency hit would not be big. It only takes 2-5 milliseconds to do the transfer using the Thunderbolt port on the Macs. With the already low tokens per second, this delay is not going to dominate the final tps.&lt;/p&gt;\n&lt;/div&gt;",
                      "gildings": {},
                      "collapsed_reason": null,
                      "distinguished": null,
                      "associated_award": null,
                      "stickied": false,
                      "author_premium": false,
                      "can_gild": false,
                      "link_id": "t3_1m9q92z",
                      "unrepliable_reason": null,
                      "author_flair_text_color": null,
                      "score_hidden": false,
                      "permalink": "/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/n5905xr/",
                      "subreddit_type": "public",
                      "locked": false,
                      "report_reasons": null,
                      "created": 1753530134,
                      "author_flair_text": null,
                      "treatment_tags": [],
                      "collapsed": false,
                      "subreddit_name_prefixed": "r/LocalLLaMA",
                      "controversiality": 0,
                      "depth": 1,
                      "author_flair_background_color": null,
                      "collapsed_because_crowd_control": null,
                      "mod_reports": [],
                      "num_reports": null,
                      "ups": 1
                    }
                  }
                ],
                "before": null
              }
            },
            "user_reports": [],
            "saved": false,
            "id": "n58vjg4",
            "banned_at_utc": null,
            "mod_reason_title": null,
            "gilded": 0,
            "archived": false,
            "collapsed_reason_code": null,
            "no_follow": true,
            "author": "isugimpy",
            "can_mod_post": false,
            "created_utc": 1753527889,
            "send_replies": true,
            "parent_id": "t3_1m9q92z",
            "score": 2,
            "author_fullname": "t2_dm4gp",
            "approved_by": null,
            "mod_note": null,
            "all_awardings": [],
            "collapsed": false,
            "body": "Not an expert on this, so take my opinions with the relevant number of grains of salt, but I'm failing to see the value of this. A complete copy of a big model in system RAM on each machine is a huge cost. The power consumption will add up. The latency of just sending packets through the full networking stack of multiple machines will be significant. Much lower total throughput.\n\nI think each machine would need a complete copy of the context as well to actually make this work, and 100gbit doesn't really make a difference when you're not going to be saturating that, since everything will be sent incrementally.",
            "edited": false,
            "top_awarded_type": null,
            "author_flair_css_class": null,
            "name": "t1_n58vjg4",
            "is_submitter": false,
            "downs": 0,
            "author_flair_richtext": [],
            "author_patreon_flair": false,
            "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;Not an expert on this, so take my opinions with the relevant number of grains of salt, but I&amp;#39;m failing to see the value of this. A complete copy of a big model in system RAM on each machine is a huge cost. The power consumption will add up. The latency of just sending packets through the full networking stack of multiple machines will be significant. Much lower total throughput.&lt;/p&gt;\n\n&lt;p&gt;I think each machine would need a complete copy of the context as well to actually make this work, and 100gbit doesn&amp;#39;t really make a difference when you&amp;#39;re not going to be saturating that, since everything will be sent incrementally.&lt;/p&gt;\n&lt;/div&gt;",
            "removal_reason": null,
            "collapsed_reason": null,
            "distinguished": null,
            "associated_award": null,
            "stickied": false,
            "author_premium": false,
            "can_gild": false,
            "gildings": {},
            "unrepliable_reason": null,
            "author_flair_text_color": null,
            "score_hidden": false,
            "permalink": "/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/n58vjg4/",
            "subreddit_type": "public",
            "locked": false,
            "report_reasons": null,
            "created": 1753527889,
            "author_flair_text": null,
            "treatment_tags": [],
            "link_id": "t3_1m9q92z",
            "subreddit_name_prefixed": "r/LocalLLaMA",
            "controversiality": 0,
            "depth": 0,
            "author_flair_background_color": null,
            "collapsed_because_crowd_control": null,
            "mod_reports": [],
            "num_reports": null,
            "ups": 2
          }
        },
        {
          "kind": "t1",
          "data": {
            "subreddit_id": "t5_81eyvm",
            "approved_at_utc": null,
            "author_is_blocked": false,
            "comment_type": null,
            "awarders": [],
            "mod_reason_by": null,
            "banned_by": null,
            "author_flair_type": "text",
            "total_awards_received": 0,
            "subreddit": "LocalLLaMA",
            "author_flair_template_id": null,
            "likes": null,
            "replies": "",
            "user_reports": [],
            "saved": false,
            "id": "n58vvnm",
            "banned_at_utc": null,
            "mod_reason_title": null,
            "gilded": 0,
            "archived": false,
            "collapsed_reason_code": null,
            "no_follow": true,
            "author": "Aaaaaaaaaeeeee",
            "can_mod_post": false,
            "created_utc": 1753528061,
            "send_replies": true,
            "parent_id": "t3_1m9q92z",
            "score": 1,
            "author_fullname": "t2_el5pibmej",
            "approved_by": null,
            "mod_note": null,
            "all_awardings": [],
            "collapsed": false,
            "body": "The concept of experts put into different computers with 32-64gb RAM each or less, works via RPC distributed inference, you don't need to get the AMD EPYC if you don't have the cash.\n\n\nThey do have an optimized approach for this which can speed up, that's what tensor parallelism is capable of we're looking at doing math with the tensors **in parallel** with 8 machines which completes inference (a token generated) faster. we do not have this yet in practical ways in llama.cpp. We do have a project capable for the cpu:\n\n\n- https://github.com/b4rtaz/distributed-llama",
            "edited": false,
            "top_awarded_type": null,
            "author_flair_css_class": null,
            "name": "t1_n58vvnm",
            "is_submitter": false,
            "downs": 0,
            "author_flair_richtext": [],
            "author_patreon_flair": false,
            "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;The concept of experts put into different computers with 32-64gb RAM each or less, works via RPC distributed inference, you don&amp;#39;t need to get the AMD EPYC if you don&amp;#39;t have the cash.&lt;/p&gt;\n\n&lt;p&gt;They do have an optimized approach for this which can speed up, that&amp;#39;s what tensor parallelism is capable of we&amp;#39;re looking at doing math with the tensors &lt;strong&gt;in parallel&lt;/strong&gt; with 8 machines which completes inference (a token generated) faster. we do not have this yet in practical ways in llama.cpp. We do have a project capable for the cpu:&lt;/p&gt;\n\n&lt;p&gt;- &lt;a href=\"https://github.com/b4rtaz/distributed-llama\"&gt;https://github.com/b4rtaz/distributed-llama&lt;/a&gt;&lt;/p&gt;\n&lt;/div&gt;",
            "removal_reason": null,
            "collapsed_reason": null,
            "distinguished": null,
            "associated_award": null,
            "stickied": false,
            "author_premium": false,
            "can_gild": false,
            "gildings": {},
            "unrepliable_reason": null,
            "author_flair_text_color": null,
            "score_hidden": false,
            "permalink": "/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/n58vvnm/",
            "subreddit_type": "public",
            "locked": false,
            "report_reasons": null,
            "created": 1753528061,
            "author_flair_text": null,
            "treatment_tags": [],
            "link_id": "t3_1m9q92z",
            "subreddit_name_prefixed": "r/LocalLLaMA",
            "controversiality": 0,
            "depth": 0,
            "author_flair_background_color": null,
            "collapsed_because_crowd_control": null,
            "mod_reports": [],
            "num_reports": null,
            "ups": 1
          }
        },
        {
          "kind": "t1",
          "data": {
            "subreddit_id": "t5_81eyvm",
            "approved_at_utc": null,
            "author_is_blocked": false,
            "comment_type": null,
            "awarders": [],
            "mod_reason_by": null,
            "banned_by": null,
            "author_flair_type": "text",
            "total_awards_received": 0,
            "subreddit": "LocalLLaMA",
            "author_flair_template_id": null,
            "likes": null,
            "replies": {
              "kind": "Listing",
              "data": {
                "after": null,
                "dist": null,
                "modhash": "",
                "geo_filter": "",
                "children": [
                  {
                    "kind": "t1",
                    "data": {
                      "subreddit_id": "t5_81eyvm",
                      "approved_at_utc": null,
                      "author_is_blocked": false,
                      "comment_type": null,
                      "awarders": [],
                      "mod_reason_by": null,
                      "banned_by": null,
                      "author_flair_type": "text",
                      "total_awards_received": 0,
                      "subreddit": "LocalLLaMA",
                      "author_flair_template_id": null,
                      "likes": null,
                      "replies": "",
                      "user_reports": [],
                      "saved": false,
                      "id": "n58wswa",
                      "banned_at_utc": null,
                      "mod_reason_title": null,
                      "gilded": 0,
                      "archived": false,
                      "collapsed_reason_code": null,
                      "no_follow": true,
                      "author": "SatisfactionSuper981",
                      "can_mod_post": false,
                      "created_utc": 1753528520,
                      "send_replies": true,
                      "parent_id": "t1_n58wde1",
                      "score": 1,
                      "author_fullname": "t2_a1b60i4r",
                      "removal_reason": null,
                      "approved_by": null,
                      "mod_note": null,
                      "all_awardings": [],
                      "body": "And as said here, you can do this mostly on one machine. 8 gpus can be tricky, 4 is easy and two experts running on the gpu isn't going to slow it down much. Bigger issue is getting enough vram to run some of those monsters - Qwen3 coder is the only one that I see as manageable, as you can run that as an AWQ on 8x MI50 32GB.",
                      "edited": false,
                      "top_awarded_type": null,
                      "author_flair_css_class": null,
                      "name": "t1_n58wswa",
                      "is_submitter": false,
                      "downs": 0,
                      "author_flair_richtext": [],
                      "author_patreon_flair": false,
                      "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;And as said here, you can do this mostly on one machine. 8 gpus can be tricky, 4 is easy and two experts running on the gpu isn&amp;#39;t going to slow it down much. Bigger issue is getting enough vram to run some of those monsters - Qwen3 coder is the only one that I see as manageable, as you can run that as an AWQ on 8x MI50 32GB.&lt;/p&gt;\n&lt;/div&gt;",
                      "gildings": {},
                      "collapsed_reason": null,
                      "distinguished": null,
                      "associated_award": null,
                      "stickied": false,
                      "author_premium": false,
                      "can_gild": false,
                      "link_id": "t3_1m9q92z",
                      "unrepliable_reason": null,
                      "author_flair_text_color": null,
                      "score_hidden": false,
                      "permalink": "/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/n58wswa/",
                      "subreddit_type": "public",
                      "locked": false,
                      "report_reasons": null,
                      "created": 1753528520,
                      "author_flair_text": null,
                      "treatment_tags": [],
                      "collapsed": false,
                      "subreddit_name_prefixed": "r/LocalLLaMA",
                      "controversiality": 0,
                      "depth": 1,
                      "author_flair_background_color": null,
                      "collapsed_because_crowd_control": null,
                      "mod_reports": [],
                      "num_reports": null,
                      "ups": 1
                    }
                  }
                ],
                "before": null
              }
            },
            "user_reports": [],
            "saved": false,
            "id": "n58wde1",
            "banned_at_utc": null,
            "mod_reason_title": null,
            "gilded": 0,
            "archived": false,
            "collapsed_reason_code": null,
            "no_follow": true,
            "author": "SatisfactionSuper981",
            "can_mod_post": false,
            "created_utc": 1753528307,
            "send_replies": true,
            "parent_id": "t3_1m9q92z",
            "score": 1,
            "author_fullname": "t2_a1b60i4r",
            "approved_by": null,
            "mod_note": null,
            "all_awardings": [],
            "collapsed": false,
            "body": "You can kinda do this with VLLM already. It has a \\`expert-parallel\\` option. It also has ray, which allows distributed interference. Also better not to use the network stack, infiniband is a better solution and has throughput of 50GB/s. The only thing here is that they all need to be nvidia cards, and all the same architecture. \n\nYou might be able to do something with Llama.cpp, but it seriously starts degrading once you add two RPC servers.",
            "edited": false,
            "top_awarded_type": null,
            "author_flair_css_class": null,
            "name": "t1_n58wde1",
            "is_submitter": false,
            "downs": 0,
            "author_flair_richtext": [],
            "author_patreon_flair": false,
            "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;You can kinda do this with VLLM already. It has a `expert-parallel` option. It also has ray, which allows distributed interference. Also better not to use the network stack, infiniband is a better solution and has throughput of 50GB/s. The only thing here is that they all need to be nvidia cards, and all the same architecture. &lt;/p&gt;\n\n&lt;p&gt;You might be able to do something with Llama.cpp, but it seriously starts degrading once you add two RPC servers.&lt;/p&gt;\n&lt;/div&gt;",
            "removal_reason": null,
            "collapsed_reason": null,
            "distinguished": null,
            "associated_award": null,
            "stickied": false,
            "author_premium": false,
            "can_gild": false,
            "gildings": {},
            "unrepliable_reason": null,
            "author_flair_text_color": null,
            "score_hidden": false,
            "permalink": "/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/n58wde1/",
            "subreddit_type": "public",
            "locked": false,
            "report_reasons": null,
            "created": 1753528307,
            "author_flair_text": null,
            "treatment_tags": [],
            "link_id": "t3_1m9q92z",
            "subreddit_name_prefixed": "r/LocalLLaMA",
            "controversiality": 0,
            "depth": 0,
            "author_flair_background_color": null,
            "collapsed_because_crowd_control": null,
            "mod_reports": [],
            "num_reports": null,
            "ups": 1
          }
        },
        {
          "kind": "t1",
          "data": {
            "subreddit_id": "t5_81eyvm",
            "approved_at_utc": null,
            "author_is_blocked": false,
            "comment_type": null,
            "awarders": [],
            "mod_reason_by": null,
            "banned_by": null,
            "author_flair_type": "richtext",
            "total_awards_received": 0,
            "subreddit": "LocalLLaMA",
            "author_flair_template_id": "2b12e2b8-fdc0-11ee-9a03-6e2f48afd456",
            "likes": null,
            "replies": "",
            "user_reports": [],
            "saved": false,
            "id": "n594335",
            "banned_at_utc": null,
            "mod_reason_title": null,
            "gilded": 0,
            "archived": false,
            "collapsed_reason_code": null,
            "no_follow": true,
            "author": "Former-Ad-5757",
            "can_mod_post": false,
            "created_utc": 1753531836,
            "send_replies": true,
            "parent_id": "t3_1m9q92z",
            "score": 1,
            "author_fullname": "t2_ihsdiwk6k",
            "approved_by": null,
            "mod_note": null,
            "all_awardings": [],
            "collapsed": false,
            "body": "The problem is the expert servers will cost you more than a 5090 because they still need a good cpu and 1+tb of memory.\n\nBut I guess this is what deepseek was doing etc. It is a nice solution if you are gpu-low and server heavy. And Alibaba and tencent etc are probably server heavy.",
            "edited": false,
            "top_awarded_type": null,
            "author_flair_css_class": null,
            "name": "t1_n594335",
            "is_submitter": false,
            "downs": 0,
            "author_flair_richtext": [
              {
                "e": "text",
                "t": "Llama 3"
              }
            ],
            "author_patreon_flair": false,
            "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;The problem is the expert servers will cost you more than a 5090 because they still need a good cpu and 1+tb of memory.&lt;/p&gt;\n\n&lt;p&gt;But I guess this is what deepseek was doing etc. It is a nice solution if you are gpu-low and server heavy. And Alibaba and tencent etc are probably server heavy.&lt;/p&gt;\n&lt;/div&gt;",
            "removal_reason": null,
            "collapsed_reason": null,
            "distinguished": null,
            "associated_award": null,
            "stickied": false,
            "author_premium": false,
            "can_gild": false,
            "gildings": {},
            "unrepliable_reason": null,
            "author_flair_text_color": "light",
            "score_hidden": false,
            "permalink": "/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/n594335/",
            "subreddit_type": "public",
            "locked": false,
            "report_reasons": null,
            "created": 1753531836,
            "author_flair_text": "Llama 3",
            "treatment_tags": [],
            "link_id": "t3_1m9q92z",
            "subreddit_name_prefixed": "r/LocalLLaMA",
            "controversiality": 0,
            "depth": 0,
            "author_flair_background_color": "#c7b594",
            "collapsed_because_crowd_control": null,
            "mod_reports": [],
            "num_reports": null,
            "ups": 1
          }
        },
        {
          "kind": "t1",
          "data": {
            "subreddit_id": "t5_81eyvm",
            "approved_at_utc": null,
            "author_is_blocked": false,
            "comment_type": null,
            "awarders": [],
            "mod_reason_by": null,
            "banned_by": null,
            "author_flair_type": "richtext",
            "total_awards_received": 0,
            "subreddit": "LocalLLaMA",
            "author_flair_template_id": "ed89e5c6-72f1-11ee-9954-1697022cd89d",
            "likes": null,
            "replies": "",
            "user_reports": [],
            "saved": false,
            "id": "n5b1gsk",
            "banned_at_utc": null,
            "mod_reason_title": null,
            "gilded": 0,
            "archived": false,
            "collapsed_reason_code": null,
            "no_follow": true,
            "author": "segmond",
            "can_mod_post": false,
            "created_utc": 1753554827,
            "send_replies": true,
            "parent_id": "t3_1m9q92z",
            "score": 1,
            "author_fullname": "t2_ah13x",
            "approved_by": null,
            "mod_note": null,
            "all_awardings": [],
            "collapsed": false,
            "body": "I own 3 clusters for running big model.  The beauty of llama.cpp when it came out was that it allows us to run models that were impossible for the common man to run by either offloading to memory or sharing computer across network. I started building my 2nd rig to be able to run llama3-405b.    Then I added the 3rd for Deepseek.\n\nHere's one thing that's certain, offloading to memory kills your performance unless you have a really high end server with insane memory bandwidth.   Off loading across network even if all on GPUs kills performance, latency. 100Gbps makes no difference, its' not a bandwidth problem, it's a latency problem.  TCP/IP is not good for GPU inference.\n\nIf I load all of my qwen3-235b into my local GPU, I get about 30tk/sec.   If I offload some to ram to get more context, it drops to about 20tk/sec.   If instead of ram, I offload across network to a few GPUs on my other cluster, it drops to 4tk/sec.\n\nSo what's the lesson?  Have all your GPU if possible on just one machine and if you are gong to offload, then you better offload to a decent machine.   We all want this, but the reality is that budget is the driving factor.   So just do the best with what you have and enjoy it.",
            "edited": false,
            "top_awarded_type": null,
            "author_flair_css_class": null,
            "name": "t1_n5b1gsk",
            "is_submitter": false,
            "downs": 0,
            "author_flair_richtext": [
              {
                "e": "text",
                "t": "llama.cpp"
              }
            ],
            "author_patreon_flair": false,
            "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;I own 3 clusters for running big model.  The beauty of llama.cpp when it came out was that it allows us to run models that were impossible for the common man to run by either offloading to memory or sharing computer across network. I started building my 2nd rig to be able to run llama3-405b.    Then I added the 3rd for Deepseek.&lt;/p&gt;\n\n&lt;p&gt;Here&amp;#39;s one thing that&amp;#39;s certain, offloading to memory kills your performance unless you have a really high end server with insane memory bandwidth.   Off loading across network even if all on GPUs kills performance, latency. 100Gbps makes no difference, its&amp;#39; not a bandwidth problem, it&amp;#39;s a latency problem.  TCP/IP is not good for GPU inference.&lt;/p&gt;\n\n&lt;p&gt;If I load all of my qwen3-235b into my local GPU, I get about 30tk/sec.   If I offload some to ram to get more context, it drops to about 20tk/sec.   If instead of ram, I offload across network to a few GPUs on my other cluster, it drops to 4tk/sec.&lt;/p&gt;\n\n&lt;p&gt;So what&amp;#39;s the lesson?  Have all your GPU if possible on just one machine and if you are gong to offload, then you better offload to a decent machine.   We all want this, but the reality is that budget is the driving factor.   So just do the best with what you have and enjoy it.&lt;/p&gt;\n&lt;/div&gt;",
            "removal_reason": null,
            "collapsed_reason": null,
            "distinguished": null,
            "associated_award": null,
            "stickied": false,
            "author_premium": false,
            "can_gild": false,
            "gildings": {},
            "unrepliable_reason": null,
            "author_flair_text_color": "light",
            "score_hidden": false,
            "permalink": "/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/n5b1gsk/",
            "subreddit_type": "public",
            "locked": false,
            "report_reasons": null,
            "created": 1753554827,
            "author_flair_text": "llama.cpp",
            "treatment_tags": [],
            "link_id": "t3_1m9q92z",
            "subreddit_name_prefixed": "r/LocalLLaMA",
            "controversiality": 0,
            "depth": 0,
            "author_flair_background_color": "#bbbdbf",
            "collapsed_because_crowd_control": null,
            "mod_reports": [],
            "num_reports": null,
            "ups": 1
          }
        },
        {
          "kind": "t1",
          "data": {
            "subreddit_id": "t5_81eyvm",
            "approved_at_utc": null,
            "author_is_blocked": false,
            "comment_type": null,
            "awarders": [],
            "mod_reason_by": null,
            "banned_by": null,
            "author_flair_type": "text",
            "total_awards_received": 0,
            "subreddit": "LocalLLaMA",
            "author_flair_template_id": null,
            "likes": null,
            "replies": "",
            "user_reports": [],
            "saved": false,
            "id": "n58vm9g",
            "banned_at_utc": null,
            "mod_reason_title": null,
            "gilded": 0,
            "archived": false,
            "collapsed_reason_code": null,
            "no_follow": true,
            "author": "AbyssianOne",
            "can_mod_post": false,
            "created_utc": 1753527928,
            "send_replies": true,
            "parent_id": "t3_1m9q92z",
            "score": 0,
            "author_fullname": "t2_1651c3kskq",
            "approved_by": null,
            "mod_note": null,
            "all_awardings": [],
            "collapsed": false,
            "body": "A 5090?\n\n\nYou're looking a few tens of thousands of dollars too low. \n\n\nIt would actually be much cheaper and easier to build a single machine capable of effectively running the model. \n\n\nJust because there could possibly be a way to do a thing, doesn't mean that thing is a good plan.",
            "edited": false,
            "top_awarded_type": null,
            "author_flair_css_class": null,
            "name": "t1_n58vm9g",
            "is_submitter": false,
            "downs": 0,
            "author_flair_richtext": [],
            "author_patreon_flair": false,
            "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;A 5090?&lt;/p&gt;\n\n&lt;p&gt;You&amp;#39;re looking a few tens of thousands of dollars too low. &lt;/p&gt;\n\n&lt;p&gt;It would actually be much cheaper and easier to build a single machine capable of effectively running the model. &lt;/p&gt;\n\n&lt;p&gt;Just because there could possibly be a way to do a thing, doesn&amp;#39;t mean that thing is a good plan.&lt;/p&gt;\n&lt;/div&gt;",
            "removal_reason": null,
            "collapsed_reason": null,
            "distinguished": null,
            "associated_award": null,
            "stickied": false,
            "author_premium": false,
            "can_gild": false,
            "gildings": {},
            "unrepliable_reason": null,
            "author_flair_text_color": null,
            "score_hidden": false,
            "permalink": "/r/LocalLLaMA/comments/1m9q92z/cluster_idea_for_moe/n58vm9g/",
            "subreddit_type": "public",
            "locked": false,
            "report_reasons": null,
            "created": 1753527928,
            "author_flair_text": null,
            "treatment_tags": [],
            "link_id": "t3_1m9q92z",
            "subreddit_name_prefixed": "r/LocalLLaMA",
            "controversiality": 0,
            "depth": 0,
            "author_flair_background_color": null,
            "collapsed_because_crowd_control": null,
            "mod_reports": [],
            "num_reports": null,
            "ups": 0
          }
        }
      ],
      "before": null
    }
  }
]